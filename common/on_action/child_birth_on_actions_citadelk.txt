on_birth_child = {
    on_actions = {
        on_birth_child_CitadelK
    }
}

on_16th_birthday = {
    events = {
        selmy.0001
    }
}
on_birth_child_CitadelK = {
    effect = {
        hidden_effect = {
            if = {
                limit = {
                    exists = scope:child.dynasty
                    scope:child.dynasty = {
                        has_dynasty_perk = whent_legacy_1
                        NOT = { has_dynasty_perk = whent_legacy_5 }
                    }
                    OR = {
                        scope:mother.dynasty = scope:child.dynasty
                        scope:real_father.dynasty = scope:child.dynasty
                    }
                }
                random = {
                    chance = 15
                    scope:child = { add_trait = sickly }
                }
            }

            if = {
                limit = {
                    exists = scope:child.dynasty
                    scope:child.dynasty = {
                        has_dynasty_perk = whent_legacy_2
                        NOT = { has_dynasty_perk = whent_legacy_5 }
                    }
                    OR = {
                        scope:mother.dynasty = scope:child.dynasty
                        scope:real_father.dynasty = scope:child.dynasty
                    }
                }
                random = {
                    chance = 15
                    if = {
                        limit = { random_percent < 50 }
                        scope:child = { add_trait = possessed_1 }
                    }
                    else = {
                        scope:child = { add_trait = lunatic_1 }
                    }
                }
            }

            if = {
                limit = {
                    exists = scope:child.dynasty
                    scope:child.dynasty = { has_dynasty_perk = shawney_legacy_1 }
                    OR = {
                        scope:mother.dynasty = scope:child.dynasty
                        scope:real_father.dynasty = scope:child.dynasty
                    }
                }
                random = {
                    chance = 15
                    scope:child = { add_trait = disloyal }
                }
            }

            if = {
                limit = {
                    exists = scope:child.dynasty
                    scope:child.dynasty = { has_dynasty_perk = shawney_legacy_3 }
                    OR = {
                        scope:mother.dynasty = scope:child.dynasty
                        scope:real_father.dynasty = scope:child.dynasty
                    }
                }
                random = {
                    chance = 25
                    if = {
                        limit = { random_percent < 50 }
                        scope:child = { add_trait = shrewd }
                    }
                    else = {
                        scope:child = { add_trait = greedy }
                    }
                }
            }

            if = {
                limit = {
                    exists = scope:child.dynasty
                    scope:child.dynasty = {
                        has_dynasty_perk = selmy_legacy_1
                    }
                    OR = {
                        scope:mother.dynasty = scope:child.dynasty
                        scope:real_father.dynasty = scope:child.dynasty
                    }
                }
                random = {
                    chance = 25
                    scope:child = { add_trait = brave }
                }
            }

            if = {
                limit = {
                    exists = scope:child.dynasty
                    scope:child.dynasty = {
                        has_dynasty_perk = selmy_legacy_4
                        NOT = { has_dynasty_perk = selmy_legacy_5 }
                    }
                    OR = {
                        scope:mother.dynasty = scope:child.dynasty
                        scope:real_father.dynasty = scope:child.dynasty
                    }
                }
                random = {
                    chance = 15
                    scope:child = { add_trait = strong }
                }
            }

            if = {
                limit = {
                    exists = scope:child.dynasty
                    scope:child.dynasty = { has_dynasty_perk = selmy_legacy_5 }
                    OR = {
                        scope:mother.dynasty = scope:child.dynasty
                        scope:real_father.dynasty = scope:child.dynasty
                    }
                }
                random = {
                    chance = 1 # 1% Chance Bozo. -K
                    scope:child = {
                        set_character_flag = destined_for_quicksilver
                        add_trait = brave
                    }
                }
            }

            if = {
                limit = {
                    exists = scope:child.dynasty
                    scope:child.dynasty = {
                        has_dynasty_perk = clawman_legacy_1
                    }
                    OR = {
                        scope:mother.dynasty = scope:child.dynasty
                        scope:real_father.dynasty = scope:child.dynasty
                    }
                }
                random = {
                    chance = 15
                    scope:child = { add_trait = rowdy }
                }
            }

            if = {
                limit = {
                    exists = scope:child.dynasty
                    scope:child.dynasty = {
                        has_dynasty_perk = clawman_legacy_3
                    }
                    OR = {
                        scope:mother.dynasty = scope:child.dynasty
                        scope:real_father.dynasty = scope:child.dynasty
                    }
                }
                random = {
                    chance = 10
                    scope:child = { add_trait = stubborn }
                }
            }
        }
    }
}