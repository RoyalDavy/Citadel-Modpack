#On actions relating to relationships between characters

####################################
# NOTE
####################################
# All relations have these autogenerated, even if they're not explicitly written out here.
# The full list is:
# [relation]_quarterly_pulse
# on_set_relation_[relation]
# on_remove_relation_[relation]
# on_death_relation_[relation]
#
# The following two on_actions are scripted, rather than being called by code, so if you want one for them then it must be created and fired from the quarterly pulse.
# [relation]_status_changes
# [relation]_relation_changes
####################################

#According to PDX doc, ROOT is the DYING character
on_death_relation_agot_dragon = {
	effect = {
		if = {
			limit = {
				has_variable = current_dragon
			}
			save_scope_as = deceased_dragonrider
			var:current_dragon = {
				save_scope_as = newly_freed_dragon
			}
			every_player = {
				limit = {
					always = yes
				}
				send_interface_message = {
					type = msg_dragonrider_death
					title = agot_dragon_maintenance.0901.t
					desc = agot_dragon_maintenance_msg_dragon_rider_death_placeholder
					left_icon = scope:newly_freed_dragon
					right_icon = scope:deceased_dragonrider
				}
			}
		}
	}
}

on_set_relation_agot_dragon = {
	effect = {
		if = {
			limit = {
				has_trait = dragon
				any_relation = {
					type = agot_story_dragon
				}
			}
			random_relation = {
				type = agot_story_dragon
				limit = {
					is_human = yes
				}
				save_scope_as = story_dragon_owner
			}
			remove_relation_agot_story_dragon = scope:story_dragon_owner
		}
	}
}

on_remove_relation_agot_dragon = {

}


