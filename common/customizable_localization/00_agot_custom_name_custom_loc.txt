#Replaces GetShortUIName in localization files to account for custom titles and bastard surnames
AGOTCustomGetShortUIName = {
	type = character
	log_loc_errors = no
	text = {
		trigger = {
			OR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
				any_spouse = {
					is_ruler = yes
				}
				any_spouse = {
					primary_title.tier >= tier_barony
				}

				father ?= {
					primary_title.tier >= tier_kingdom
					primary_title.holder ?= {
						exists = yes
						NOR = {
							government_has_flag = government_is_free_city
							has_government = administrative_government
							has_government = landless_adventurer_government
						}
					}
					NOR = {
						government_has_flag = government_is_free_city
						has_government = administrative_government
						has_government = landless_adventurer_government
					}
				}
				AND = {
					mother ?= {
						primary_title.tier >= tier_kingdom
						primary_title.holder ?= {
							exists = yes
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
						NOR = {
							government_has_flag = government_is_free_city
							has_government = administrative_government
							has_government = landless_adventurer_government
						}
					}
					trigger_if = { #For when a husband is landless
						limit = {
							father ?= {
								primary_title.tier >= tier_barony
								primary_title.tier >= root.mother.primary_title.tier
							}
						}
						father ?= {
							primary_title.holder ?= {
								exists = yes
								NOR = {
									government_has_flag = government_is_free_city
									has_government = administrative_government
									has_government = landless_adventurer_government
									primary_title.tier < tier_kingdom
								}
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
				}
				is_lowborn = yes
			}
			NOR = {
				has_title = title:k_the_most_devout
				AND = {
					has_trait = silent_sister
					is_ruler = no
				}
				AND = {
					OR = {
						has_trait = maester
						has_trait = maester_historical
					}
					is_ruler = no
				}
				AND = {
					OR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOT = { has_trait = silent_sister }
					OR = {
						has_trait = knight
						AND = {
							has_trait_xp = {
								trait = squire
								track = knight
								value >= 100
							}
							OR = {
								age >= 16 #You are at least 16
								AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
									age < 16
									age >= 12
									#Youngest knight was Daemon Blackfyre
									prowess >= extremely_high_skill_rating
								}
							}
						}
					}
					NOR = {
						has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
						has_trait = maester_historical
					}
					NOT = { has_council_position = kingsguard_lord_commander}
					NOT = { any_spouse = { is_ruler = yes } }
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
				}
				AND = {
					OR = {
						has_trait = knight
						AND = {
							has_trait_xp = {
								trait = squire
								track = knight
								value >= 100
							}
							OR = {
								age >= 16 #You are at least 16
								AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
									age < 16
									age >= 12
									#Youngest knight was Daemon Blackfyre
									prowess >= extremely_high_skill_rating
								}
							}
						}
					}

					NOR = {
						has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
						has_trait = maester_historical
					}
					NOT = {
						has_council_position = kingsguard_lord_commander
						primary_title ?= title:d_kingsguard
					}
					NOT = { any_spouse = { is_ruler = yes } }
					NOR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOT = { has_trait = silent_sister }
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
						father ?= {
							primary_title.tier >= tier_kingdom
							OR = {
								AND = {
									primary_title.holder ?= {
										exists = yes
									}
									primary_title ?= title:k_dragonstone
									dynasty ?= dynasty:dynn_Targaryen
									agot_is_independent_ruler = no
								}
								primary_title.holder ?= {
									exists = yes
									OR = {
										agot_is_independent_ruler = yes
										vassal_contract_has_flag = has_palatinate_contract
									}
									NOR = {
										government_has_flag = government_is_free_city
										has_government = administrative_government
										has_government = landless_adventurer_government
									}
								}
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
						mother ?= {
							primary_title.tier >= tier_kingdom
							OR = {
								AND = {
									primary_title.holder ?= {
										exists = yes
									}
									primary_title ?= title:k_dragonstone
									dynasty ?= dynasty:dynn_Targaryen
									agot_is_independent_ruler = no
								}
								primary_title.holder ?= {
									exists = yes
									OR = {
										agot_is_independent_ruler = yes
										vassal_contract_has_flag = has_palatinate_contract
									}
									NOR = {
										government_has_flag = government_is_free_city
										has_government = administrative_government
										has_government = landless_adventurer_government
									}
								}
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
				}
				AND = {
					OR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
					NOT = { has_council_position = kingsguard_lord_commander}
					NOT = { any_spouse = { is_ruler = yes } }
					NOT = { has_trait = silent_sister }
					NOT = {
						OR = {
							has_trait = knight
							AND = {
								has_trait_xp = {
									trait = squire
									track = knight
									value >= 100
								}
								OR = {
									age >= 16 #You are at least 16
									AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
										age < 16
										age >= 12
										#Youngest knight was Daemon Blackfyre
										prowess >= extremely_high_skill_rating
									}
								}
							}
						}
						OR = {
							has_trait = maester
							has_trait = maester_historical
						}
					}
				}
			}
		}
		localization_key = agot_landed_name_short
	}

	text = {
		trigger = {
			NOR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
				any_spouse = {
					is_ruler = yes
				}
				any_spouse = {
					primary_title.tier >= tier_barony
				}

				father ?= {
					primary_title.tier >= tier_kingdom
					primary_title.holder ?= {
						exists = yes
						NOR = {
							government_has_flag = government_is_free_city
							has_government = administrative_government
							has_government = landless_adventurer_government
						}
					}
					NOR = {
						government_has_flag = government_is_free_city
						has_government = administrative_government
						has_government = landless_adventurer_government
					}
				}
				AND = {
					mother ?= {
						primary_title.tier >= tier_kingdom
						primary_title.holder ?= {
							exists = yes
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
						NOR = {
							government_has_flag = government_is_free_city
							has_government = administrative_government
							has_government = landless_adventurer_government
						}
					}
					trigger_if = { #For when a husband is landless
						limit = {
							father ?= {
								primary_title.tier >= tier_barony
								primary_title.tier >= root.mother.primary_title.tier
							}
						}
						father ?= {
							primary_title.holder ?= {
								exists = yes
								NOR = {
									government_has_flag = government_is_free_city
									has_government = administrative_government
									has_government = landless_adventurer_government
									primary_title.tier < tier_kingdom
								}
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
				}
				is_lowborn = yes
			}
			NOR = {
				has_title = title:k_the_most_devout
				AND = {
					has_trait = silent_sister
					is_ruler = no
				}
				AND = {
					OR = {
						has_trait = maester
						has_trait = maester_historical
					}
					is_ruler = no
				}
				AND = {
					OR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOT = { has_trait = silent_sister }
					OR = {
						has_trait = knight
						AND = {
							has_trait_xp = {
								trait = squire
								track = knight
								value >= 100
							}
							OR = {
								age >= 16 #You are at least 16
								AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
									age < 16
									age >= 12
									#Youngest knight was Daemon Blackfyre
									prowess >= extremely_high_skill_rating
								}
							}
						}
					}
					NOR = {
						has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
						has_trait = maester_historical
					}
					NOT = { has_council_position = kingsguard_lord_commander}
					NOT = { any_spouse = { is_ruler = yes } }
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
				}
				AND = {
					OR = {
						has_trait = knight
						AND = {
							has_trait_xp = {
								trait = squire
								track = knight
								value >= 100
							}
							OR = {
								age >= 16 #You are at least 16
								AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
									age < 16
									age >= 12
									#Youngest knight was Daemon Blackfyre
									prowess >= extremely_high_skill_rating
								}
							}
						}
					}

					NOR = {
						has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
						has_trait = maester_historical
					}
					NOT = {
						has_council_position = kingsguard_lord_commander
						primary_title ?= title:d_kingsguard
					}
					NOT = { any_spouse = { is_ruler = yes } }
					NOR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOT = { has_trait = silent_sister }
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
				}
				AND = {
					OR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
					NOT = { has_council_position = kingsguard_lord_commander}
					NOT = { any_spouse = { is_ruler = yes } }
					NOT = { has_trait = silent_sister }
					NOT = {
						OR = {
							has_trait = knight
							AND = {
								has_trait_xp = {
									trait = squire
									track = knight
									value >= 100
								}
								OR = {
									age >= 16 #You are at least 16
									AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
										age < 16
										age >= 12
										#Youngest knight was Daemon Blackfyre
										prowess >= extremely_high_skill_rating
									}
								}
							}
						}
						OR = {
							has_trait = maester
							has_trait = maester_historical
						}
					}
				}
			}
		}
		localization_key = agot_unlanded_name_short
	}

	text = {
		trigger = {
			OR = {
				has_trait = knight
				AND = {
					has_trait_xp = {
						trait = squire
						track = knight
						value >= 100
					}
					OR = {
						age >= 16 #You are at least 16
						AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
							age < 16
							age >= 12
							#Youngest knight was Daemon Blackfyre
							prowess >= extremely_high_skill_rating
						}
					}
				}
			}

			NOR = {
				has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
				has_trait = maester_historical
			}
			NOT = {
				has_council_position = kingsguard_lord_commander
				primary_title ?= title:d_kingsguard
			}
			NOT = { any_spouse = { is_ruler = yes } }
			NOR = {
				has_trait = bastard
				AND = {
					has_trait = legitimized_bastard
					OR = {
						has_inactive_trait = surname_flowers
						has_inactive_trait = surname_hill
						has_inactive_trait = surname_pyke
						has_inactive_trait = surname_rivers
						has_inactive_trait = surname_sand
						has_inactive_trait = surname_snow
						has_inactive_trait = surname_stone
						has_inactive_trait = surname_storm
						has_inactive_trait = surname_waters
					}
				}
			}
			NOT = { has_trait = silent_sister }
			NOR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
			}

			#Princes/Princesses
			NOR = {
				father ?= {
					primary_title.tier >= tier_kingdom
					OR = {
						AND = {
							primary_title.holder ?= {
								exists = yes
							}
							primary_title ?= title:k_dragonstone
							dynasty ?= dynasty:dynn_Targaryen
							agot_is_independent_ruler = no
						}
						primary_title.holder ?= {
							exists = yes
							OR = {
								agot_is_independent_ruler = yes
								vassal_contract_has_flag = has_palatinate_contract
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
					NOR = {
						government_has_flag = government_is_free_city
						has_government = administrative_government
						has_government = landless_adventurer_government
					}
				}
				mother ?= {
					primary_title.tier >= tier_kingdom
					OR = {
						AND = {
							primary_title.holder ?= {
								exists = yes
							}
							primary_title ?= title:k_dragonstone
							dynasty ?= dynasty:dynn_Targaryen
						}
						primary_title.holder ?= {
							exists = yes
							OR = {
								agot_is_independent_ruler = yes
								vassal_contract_has_flag = has_palatinate_contract
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
					NOR = {
						government_has_flag = government_is_free_city
						has_government = administrative_government
						has_government = landless_adventurer_government
					}
				}
			}
		}
		localization_key = agot_knight_name_short
	}

	text = {
		trigger = {
			OR = {
				has_trait = bastard
				AND = {
					has_trait = legitimized_bastard
					OR = {
						has_inactive_trait = surname_flowers
						has_inactive_trait = surname_hill
						has_inactive_trait = surname_pyke
						has_inactive_trait = surname_rivers
						has_inactive_trait = surname_sand
						has_inactive_trait = surname_snow
						has_inactive_trait = surname_stone
						has_inactive_trait = surname_storm
						has_inactive_trait = surname_waters
					}
				}
			}
			NOR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
			}
			NOT = { has_council_position = kingsguard_lord_commander}
			NOT = { any_spouse = { is_ruler = yes } }
			NOT = { has_trait = silent_sister }
			NOT = {
				OR = {
					has_trait = knight
					AND = {
						has_trait_xp = {
							trait = squire
							track = knight
							value >= 100
						}
						OR = {
							age >= 16 #You are at least 16
							AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
								age < 16
								age >= 12
								#Youngest knight was Daemon Blackfyre
								prowess >= extremely_high_skill_rating
							}
						}
					}
				}
				OR = {
					has_trait = maester
					has_trait = maester_historical
				}
			}
		}
		localization_key = agot_bastard_name_short
	}
	text = {
		trigger = {
			OR = {
				has_trait = bastard
				AND = {
					has_trait = legitimized_bastard
					OR = {
						has_inactive_trait = surname_flowers
						has_inactive_trait = surname_hill
						has_inactive_trait = surname_pyke
						has_inactive_trait = surname_rivers
						has_inactive_trait = surname_sand
						has_inactive_trait = surname_snow
						has_inactive_trait = surname_stone
						has_inactive_trait = surname_storm
						has_inactive_trait = surname_waters
					}
				}
			}
			NOT = { has_trait = silent_sister }
			OR = {
				has_trait = knight
				AND = {
					has_trait_xp = {
						trait = squire
						track = knight
						value >= 100
					}
					OR = {
						age >= 16 #You are at least 16
						AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
							age < 16
							age >= 12
							#Youngest knight was Daemon Blackfyre
							prowess >= extremely_high_skill_rating
						}
					}
				}
			}
			NOR = {
				has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
				has_trait = maester_historical
			}
			NOT = { has_council_position = kingsguard_lord_commander}
			NOT = { any_spouse = { is_ruler = yes } }
			NOR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
			}
		}
		localization_key = agot_knight_bastard_name_short
	}
	text = {
		trigger = {
			OR = {
				has_trait = maester
				has_trait = maester_historical
			}
			is_ruler = no
		}
		localization_key = agot_maester_name_short
	}
	text = {
		trigger = {
			OR = {
				has_trait = silent_sister
				is_ruler = no
			}
			is_ruler = no
		}
		localization_key = agot_silent_sister_name_short
	}
	text = {
		trigger = {
			has_title = title:k_the_most_devout
		}
		localization_key = agot_high_septon_name_short
	}
	text = {
		fallback = yes
		localization_key = agot_regular_short_name #Necessary since things might break
	}
}

#Replaces GetShortUIName in localization files to account for custom titles and bastard surnames
AGOTCustomGetShortUINameOrMe = {
	type = character
	log_loc_errors = no
	text = {
		trigger = {
			is_local_player = yes
		}
		localization_key = agot_me_name_short
	}
	text = {
		trigger = {
			is_local_player = no
			OR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
				any_spouse = {
					is_ruler = yes
				}
				any_spouse = {
					primary_title.tier >= tier_barony
				}

				father ?= {
					primary_title.tier >= tier_kingdom
					primary_title.holder ?= {
						exists = yes
						NOR = {
							government_has_flag = government_is_free_city
							has_government = administrative_government
							has_government = landless_adventurer_government
						}
					}
					NOR = {
						government_has_flag = government_is_free_city
						has_government = administrative_government
						has_government = landless_adventurer_government
					}
				}
				AND = {
					mother ?= {
						primary_title.tier >= tier_kingdom
						primary_title.holder ?= {
							exists = yes
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
						NOR = {
							government_has_flag = government_is_free_city
							has_government = administrative_government
							has_government = landless_adventurer_government
						}
					}
					trigger_if = { #For when a husband is landless
						limit = {
							father ?= {
								primary_title.tier >= tier_barony
								primary_title.tier >= root.mother.primary_title.tier
							}
						}
						father ?= {
							primary_title.holder ?= {
								exists = yes
								NOR = {
									government_has_flag = government_is_free_city
									has_government = administrative_government
									has_government = landless_adventurer_government
									primary_title.tier < tier_kingdom
								}
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
				}
				is_lowborn = yes
			}
			NOR = {
				has_title = title:k_the_most_devout
				AND = {
					has_trait = silent_sister
					is_ruler = no
				}
				AND = {
					OR = {
						has_trait = maester
						has_trait = maester_historical
					}
					is_ruler = no
				}
				AND = {
					OR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOT = { has_trait = silent_sister }
					OR = {
						has_trait = knight
						AND = {
							has_trait_xp = {
								trait = squire
								track = knight
								value >= 100
							}
							OR = {
								age >= 16 #You are at least 16
								AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
									age < 16
									age >= 12
									#Youngest knight was Daemon Blackfyre
									prowess >= extremely_high_skill_rating
								}
							}
						}
					}
					NOR = {
						has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
						has_trait = maester_historical
					}
					NOT = { has_council_position = kingsguard_lord_commander}
					NOT = { any_spouse = { is_ruler = yes } }
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
				}
				AND = {
					OR = {
						has_trait = knight
						AND = {
							has_trait_xp = {
								trait = squire
								track = knight
								value >= 100
							}
							OR = {
								age >= 16 #You are at least 16
								AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
									age < 16
									age >= 12
									#Youngest knight was Daemon Blackfyre
									prowess >= extremely_high_skill_rating
								}
							}
						}
					}

					NOR = {
						has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
						has_trait = maester_historical
					}
					NOT = {
						has_council_position = kingsguard_lord_commander
						primary_title ?= title:d_kingsguard
					}
					NOT = { any_spouse = { is_ruler = yes } }
					NOR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOT = { has_trait = silent_sister }
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
						father ?= {
							primary_title.tier >= tier_kingdom
							OR = {
								AND = {
									primary_title.holder ?= {
										exists = yes
									}
									primary_title ?= title:k_dragonstone
									dynasty ?= dynasty:dynn_Targaryen
									agot_is_independent_ruler = no
								}
								primary_title.holder ?= {
									exists = yes
									OR = {
										agot_is_independent_ruler = yes
										vassal_contract_has_flag = has_palatinate_contract
									}
									NOR = {
										government_has_flag = government_is_free_city
										has_government = administrative_government
										has_government = landless_adventurer_government
									}
								}
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
						mother ?= {
							primary_title.tier >= tier_kingdom
							OR = {
								AND = {
									primary_title.holder ?= {
										exists = yes
									}
									primary_title ?= title:k_dragonstone
									dynasty ?= dynasty:dynn_Targaryen
									agot_is_independent_ruler = no
								}
								primary_title.holder ?= {
									exists = yes
									OR = {
										agot_is_independent_ruler = yes
										vassal_contract_has_flag = has_palatinate_contract
									}
									NOR = {
										government_has_flag = government_is_free_city
										has_government = administrative_government
										has_government = landless_adventurer_government
									}
								}
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
				}
				AND = {
					OR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
					NOT = { has_council_position = kingsguard_lord_commander}
					NOT = { any_spouse = { is_ruler = yes } }
					NOT = { has_trait = silent_sister }
					NOT = {
						OR = {
							has_trait = knight
							AND = {
								has_trait_xp = {
									trait = squire
									track = knight
									value >= 100
								}
								OR = {
									age >= 16 #You are at least 16
									AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
										age < 16
										age >= 12
										#Youngest knight was Daemon Blackfyre
										prowess >= extremely_high_skill_rating
									}
								}
							}
						}
						OR = {
							has_trait = maester
							has_trait = maester_historical
						}
					}
				}
			}
		}
		localization_key = agot_landed_name_short_me
	}

	text = {
		trigger = {
			is_local_player = no
			NOR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
				any_spouse = {
					is_ruler = yes
				}
				any_spouse = {
					primary_title.tier >= tier_barony
				}

				father ?= {
					primary_title.tier >= tier_kingdom
					primary_title.holder ?= {
						exists = yes
						NOR = {
							government_has_flag = government_is_free_city
							has_government = administrative_government
							has_government = landless_adventurer_government
						}
					}
					NOR = {
						government_has_flag = government_is_free_city
						has_government = administrative_government
						has_government = landless_adventurer_government
					}
				}
				AND = {
					mother ?= {
						primary_title.tier >= tier_kingdom
						primary_title.holder ?= {
							exists = yes
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
						NOR = {
							government_has_flag = government_is_free_city
							has_government = administrative_government
							has_government = landless_adventurer_government
						}
					}
					trigger_if = { #For when a husband is landless
						limit = {
							father ?= {
								primary_title.tier >= tier_barony
								primary_title.tier >= root.mother.primary_title.tier
							}
						}
						father ?= {
							primary_title.holder ?= {
								exists = yes
								NOR = {
									government_has_flag = government_is_free_city
									has_government = administrative_government
									has_government = landless_adventurer_government
									primary_title.tier < tier_kingdom
								}
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
				}
				is_lowborn = yes
			}
			NOR = {
				has_title = title:k_the_most_devout
				AND = {
					has_trait = silent_sister
					is_ruler = no
				}
				AND = {
					OR = {
						has_trait = maester
						has_trait = maester_historical
					}
					is_ruler = no
				}
				AND = {
					OR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOT = { has_trait = silent_sister }
					OR = {
						has_trait = knight
						AND = {
							has_trait_xp = {
								trait = squire
								track = knight
								value >= 100
							}
							OR = {
								age >= 16 #You are at least 16
								AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
									age < 16
									age >= 12
									#Youngest knight was Daemon Blackfyre
									prowess >= extremely_high_skill_rating
								}
							}
						}
					}
					NOR = {
						has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
						has_trait = maester_historical
					}
					NOT = { has_council_position = kingsguard_lord_commander}
					NOT = { any_spouse = { is_ruler = yes } }
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
				}
				AND = {
					OR = {
						has_trait = knight
						AND = {
							has_trait_xp = {
								trait = squire
								track = knight
								value >= 100
							}
							OR = {
								age >= 16 #You are at least 16
								AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
									age < 16
									age >= 12
									#Youngest knight was Daemon Blackfyre
									prowess >= extremely_high_skill_rating
								}
							}
						}
					}

					NOR = {
						has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
						has_trait = maester_historical
					}
					NOT = {
						has_council_position = kingsguard_lord_commander
						primary_title ?= title:d_kingsguard
					}
					NOT = { any_spouse = { is_ruler = yes } }
					NOR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOT = { has_trait = silent_sister }
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
				}
				AND = {
					OR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
					NOT = { has_council_position = kingsguard_lord_commander}
					NOT = { any_spouse = { is_ruler = yes } }
					NOT = { has_trait = silent_sister }
					NOT = {
						OR = {
							has_trait = knight
							AND = {
								has_trait_xp = {
									trait = squire
									track = knight
									value >= 100
								}
								OR = {
									age >= 16 #You are at least 16
									AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
										age < 16
										age >= 12
										#Youngest knight was Daemon Blackfyre
										prowess >= extremely_high_skill_rating
									}
								}
							}
						}
						OR = {
							has_trait = maester
							has_trait = maester_historical
						}
					}
				}
			}
		}
		localization_key = agot_unlanded_name_short_me
	}

	text = {
		trigger = {
			is_local_player = no
			OR = {
				has_trait = knight
				AND = {
					has_trait_xp = {
						trait = squire
						track = knight
						value >= 100
					}
					OR = {
						age >= 16 #You are at least 16
						AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
							age < 16
							age >= 12
							#Youngest knight was Daemon Blackfyre
							prowess >= extremely_high_skill_rating
						}
					}
				}
			}

			NOR = {
				has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
				has_trait = maester_historical
			}
			NOT = {
				has_council_position = kingsguard_lord_commander
				primary_title ?= title:d_kingsguard
			}
			NOT = { any_spouse = { is_ruler = yes } }
			NOR = {
				has_trait = bastard
				AND = {
					has_trait = legitimized_bastard
					OR = {
						has_inactive_trait = surname_flowers
						has_inactive_trait = surname_hill
						has_inactive_trait = surname_pyke
						has_inactive_trait = surname_rivers
						has_inactive_trait = surname_sand
						has_inactive_trait = surname_snow
						has_inactive_trait = surname_stone
						has_inactive_trait = surname_storm
						has_inactive_trait = surname_waters
					}
				}
			}
			NOT = { has_trait = silent_sister }
			NOR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
			}

			#Princes/Princesses
			NOR = {
				father ?= {
					primary_title.tier >= tier_kingdom
					OR = {
						AND = {
							primary_title.holder ?= {
								exists = yes
							}
							primary_title ?= title:k_dragonstone
							dynasty ?= dynasty:dynn_Targaryen
							agot_is_independent_ruler = no
						}
						primary_title.holder ?= {
							exists = yes
							OR = {
								agot_is_independent_ruler = yes
								vassal_contract_has_flag = has_palatinate_contract
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
					NOR = {
						government_has_flag = government_is_free_city
						has_government = administrative_government
						has_government = landless_adventurer_government
					}
				}
				mother ?= {
					primary_title.tier >= tier_kingdom
					OR = {
						AND = {
							primary_title.holder ?= {
								exists = yes
							}
							primary_title ?= title:k_dragonstone
							dynasty ?= dynasty:dynn_Targaryen
						}
						primary_title.holder ?= {
							exists = yes
							OR = {
								agot_is_independent_ruler = yes
								vassal_contract_has_flag = has_palatinate_contract
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
					NOR = {
						government_has_flag = government_is_free_city
						has_government = administrative_government
						has_government = landless_adventurer_government
					}
				}
			}
		}
		localization_key = agot_knight_name_short_me
	}

	text = {
		trigger = {
			is_local_player = no
			OR = {
				has_trait = bastard
				AND = {
					has_trait = legitimized_bastard
					OR = {
						has_inactive_trait = surname_flowers
						has_inactive_trait = surname_hill
						has_inactive_trait = surname_pyke
						has_inactive_trait = surname_rivers
						has_inactive_trait = surname_sand
						has_inactive_trait = surname_snow
						has_inactive_trait = surname_stone
						has_inactive_trait = surname_storm
						has_inactive_trait = surname_waters
					}
				}
			}
			NOR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
			}
			NOT = { has_council_position = kingsguard_lord_commander}
			NOT = { any_spouse = { is_ruler = yes } }
			NOT = { has_trait = silent_sister }
			NOT = {
				OR = {
					has_trait = knight
					AND = {
						has_trait_xp = {
							trait = squire
							track = knight
							value >= 100
						}
						OR = {
							age >= 16 #You are at least 16
							AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
								age < 16
								age >= 12
								#Youngest knight was Daemon Blackfyre
								prowess >= extremely_high_skill_rating
							}
						}
					}
				}
				OR = {
					has_trait = maester
					has_trait = maester_historical
				}
			}
		}
		localization_key = agot_bastard_name_short_me
	}
	text = {
		trigger = {
			is_local_player = no
			OR = {
				has_trait = bastard
				AND = {
					has_trait = legitimized_bastard
					OR = {
						has_inactive_trait = surname_flowers
						has_inactive_trait = surname_hill
						has_inactive_trait = surname_pyke
						has_inactive_trait = surname_rivers
						has_inactive_trait = surname_sand
						has_inactive_trait = surname_snow
						has_inactive_trait = surname_stone
						has_inactive_trait = surname_storm
						has_inactive_trait = surname_waters
					}
				}
			}
			NOT = { has_trait = silent_sister }
			OR = {
				has_trait = knight
				AND = {
					has_trait_xp = {
						trait = squire
						track = knight
						value >= 100
					}
					OR = {
						age >= 16 #You are at least 16
						AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
							age < 16
							age >= 12
							#Youngest knight was Daemon Blackfyre
							prowess >= extremely_high_skill_rating
						}
					}
				}
			}
			NOR = {
				has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
				has_trait = maester_historical
			}
			NOT = { has_council_position = kingsguard_lord_commander}
			NOT = { any_spouse = { is_ruler = yes } }
			NOR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
			}
		}
		localization_key = agot_knight_bastard_name_short_me
	}
	text = {
		trigger = {
			is_local_player = no
			OR = {
				has_trait = maester
				has_trait = maester_historical
			}
			is_ruler = no
		}
		localization_key = agot_maester_name_short_me
	}
	text = {
		trigger = {
			is_local_player = no
			OR = {
				has_trait = silent_sister
				is_ruler = no
			}
			is_ruler = no
		}
		localization_key = agot_silent_sister_name_short_me
	}
	text = {
		trigger = {
			is_local_player = no
			has_title = title:k_the_most_devout
		}
		localization_key = agot_high_septon_name_short_me
	}
	text = {
		trigger = {
			is_local_player = no
		}
		fallback = yes
		localization_key = agot_regular_short_name #Necessary since things might break
	}
}


#Replaces GetShortUIName in localization files to account for custom titles and bastard surnames
AGOTCustomGetUINameOrMe = {
	type = character
	log_loc_errors = no
	text = {
		trigger = {
			is_local_player = yes
		}
		localization_key = agot_me_name_long
	}
	text = {
		trigger = {
			is_local_player = no
			OR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
				any_spouse = {
					is_ruler = yes
				}
				any_spouse = {
					primary_title.tier >= tier_barony
				}

				father ?= {
					primary_title.tier >= tier_kingdom
					primary_title.holder ?= {
						exists = yes
						NOR = {
							government_has_flag = government_is_free_city
							has_government = administrative_government
							has_government = landless_adventurer_government
						}
					}
					NOR = {
						government_has_flag = government_is_free_city
						has_government = administrative_government
						has_government = landless_adventurer_government
					}
				}
				AND = {
					mother ?= {
						primary_title.tier >= tier_kingdom
						primary_title.holder ?= {
							exists = yes
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
						NOR = {
							government_has_flag = government_is_free_city
							has_government = administrative_government
							has_government = landless_adventurer_government
						}
					}
					trigger_if = { #For when a husband is landless
						limit = {
							father ?= {
								primary_title.tier >= tier_barony
								primary_title.tier >= root.mother.primary_title.tier
							}
						}
						father ?= {
							primary_title.holder ?= {
								exists = yes
								NOR = {
									government_has_flag = government_is_free_city
									has_government = administrative_government
									has_government = landless_adventurer_government
									primary_title.tier < tier_kingdom
								}
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
				}
				is_lowborn = yes
			}
			NOR = {
				has_title = title:k_the_most_devout
				AND = {
					has_trait = silent_sister
					is_ruler = no
				}
				AND = {
					OR = {
						has_trait = maester
						has_trait = maester_historical
					}
					is_ruler = no
				}
				AND = {
					OR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOT = { has_trait = silent_sister }
					OR = {
						has_trait = knight
						AND = {
							has_trait_xp = {
								trait = squire
								track = knight
								value >= 100
							}
							OR = {
								age >= 16 #You are at least 16
								AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
									age < 16
									age >= 12
									#Youngest knight was Daemon Blackfyre
									prowess >= extremely_high_skill_rating
								}
							}
						}
					}
					NOR = {
						has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
						has_trait = maester_historical
					}
					NOT = { has_council_position = kingsguard_lord_commander}
					NOT = { any_spouse = { is_ruler = yes } }
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
				}
				AND = {
					OR = {
						has_trait = knight
						AND = {
							has_trait_xp = {
								trait = squire
								track = knight
								value >= 100
							}
							OR = {
								age >= 16 #You are at least 16
								AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
									age < 16
									age >= 12
									#Youngest knight was Daemon Blackfyre
									prowess >= extremely_high_skill_rating
								}
							}
						}
					}

					NOR = {
						has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
						has_trait = maester_historical
					}
					NOT = {
						has_council_position = kingsguard_lord_commander
						primary_title ?= title:d_kingsguard
					}
					NOT = { any_spouse = { is_ruler = yes } }
					NOR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOT = { has_trait = silent_sister }
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
						father ?= {
							primary_title.tier >= tier_kingdom
							OR = {
								AND = {
									primary_title.holder ?= {
										exists = yes
									}
									primary_title ?= title:k_dragonstone
									dynasty ?= dynasty:dynn_Targaryen
									agot_is_independent_ruler = no
								}
								primary_title.holder ?= {
									exists = yes
									OR = {
										agot_is_independent_ruler = yes
										vassal_contract_has_flag = has_palatinate_contract
									}
									NOR = {
										government_has_flag = government_is_free_city
										has_government = administrative_government
										has_government = landless_adventurer_government
									}
								}
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
						mother ?= {
							primary_title.tier >= tier_kingdom
							OR = {
								AND = {
									primary_title.holder ?= {
										exists = yes
									}
									primary_title ?= title:k_dragonstone
									dynasty ?= dynasty:dynn_Targaryen
									agot_is_independent_ruler = no
								}
								primary_title.holder ?= {
									exists = yes
									OR = {
										agot_is_independent_ruler = yes
										vassal_contract_has_flag = has_palatinate_contract
									}
									NOR = {
										government_has_flag = government_is_free_city
										has_government = administrative_government
										has_government = landless_adventurer_government
									}
								}
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
				}
				AND = {
					OR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
					NOT = { has_council_position = kingsguard_lord_commander}
					NOT = { any_spouse = { is_ruler = yes } }
					NOT = { has_trait = silent_sister }
					NOT = {
						OR = {
							has_trait = knight
							AND = {
								has_trait_xp = {
									trait = squire
									track = knight
									value >= 100
								}
								OR = {
									age >= 16 #You are at least 16
									AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
										age < 16
										age >= 12
										#Youngest knight was Daemon Blackfyre
										prowess >= extremely_high_skill_rating
									}
								}
							}
						}
						OR = {
							has_trait = maester
							has_trait = maester_historical
						}
					}
				}
			}
		}
		localization_key = agot_landed_name_long_me
	}

	text = {
		trigger = {
			is_local_player = no
			NOR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
				any_spouse = {
					is_ruler = yes
				}
				any_spouse = {
					primary_title.tier >= tier_barony
				}

				father ?= {
					primary_title.tier >= tier_kingdom
					primary_title.holder ?= {
						exists = yes
						NOR = {
							government_has_flag = government_is_free_city
							has_government = administrative_government
							has_government = landless_adventurer_government
						}
					}
					NOR = {
						government_has_flag = government_is_free_city
						has_government = administrative_government
						has_government = landless_adventurer_government
					}
				}
				AND = {
					mother ?= {
						primary_title.tier >= tier_kingdom
						primary_title.holder ?= {
							exists = yes
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
						NOR = {
							government_has_flag = government_is_free_city
							has_government = administrative_government
							has_government = landless_adventurer_government
						}
					}
					trigger_if = { #For when a husband is landless
						limit = {
							father ?= {
								primary_title.tier >= tier_barony
								primary_title.tier >= root.mother.primary_title.tier
							}
						}
						father ?= {
							primary_title.holder ?= {
								exists = yes
								NOR = {
									government_has_flag = government_is_free_city
									has_government = administrative_government
									has_government = landless_adventurer_government
									primary_title.tier < tier_kingdom
								}
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
				}
				is_lowborn = yes
			}
			NOR = {
				has_title = title:k_the_most_devout
				AND = {
					has_trait = silent_sister
					is_ruler = no
				}
				AND = {
					OR = {
						has_trait = maester
						has_trait = maester_historical
					}
					is_ruler = no
				}
				AND = {
					OR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOT = { has_trait = silent_sister }
					OR = {
						has_trait = knight
						AND = {
							has_trait_xp = {
								trait = squire
								track = knight
								value >= 100
							}
							OR = {
								age >= 16 #You are at least 16
								AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
									age < 16
									age >= 12
									#Youngest knight was Daemon Blackfyre
									prowess >= extremely_high_skill_rating
								}
							}
						}
					}
					NOR = {
						has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
						has_trait = maester_historical
					}
					NOT = { has_council_position = kingsguard_lord_commander}
					NOT = { any_spouse = { is_ruler = yes } }
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
				}
				AND = {
					OR = {
						has_trait = knight
						AND = {
							has_trait_xp = {
								trait = squire
								track = knight
								value >= 100
							}
							OR = {
								age >= 16 #You are at least 16
								AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
									age < 16
									age >= 12
									#Youngest knight was Daemon Blackfyre
									prowess >= extremely_high_skill_rating
								}
							}
						}
					}

					NOR = {
						has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
						has_trait = maester_historical
					}
					NOT = {
						has_council_position = kingsguard_lord_commander
						primary_title ?= title:d_kingsguard
					}
					NOT = { any_spouse = { is_ruler = yes } }
					NOR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOT = { has_trait = silent_sister }
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
				}
				AND = {
					OR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
					NOT = { has_council_position = kingsguard_lord_commander}
					NOT = { any_spouse = { is_ruler = yes } }
					NOT = { has_trait = silent_sister }
					NOT = {
						OR = {
							has_trait = knight
							AND = {
								has_trait_xp = {
									trait = squire
									track = knight
									value >= 100
								}
								OR = {
									age >= 16 #You are at least 16
									AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
										age < 16
										age >= 12
										#Youngest knight was Daemon Blackfyre
										prowess >= extremely_high_skill_rating
									}
								}
							}
						}
						OR = {
							has_trait = maester
							has_trait = maester_historical
						}
					}
				}
			}
		}
		localization_key = agot_unlanded_name_long_me
	}

	text = {
		trigger = {
			is_local_player = no
			OR = {
				has_trait = knight
				AND = {
					has_trait_xp = {
						trait = squire
						track = knight
						value >= 100
					}
					OR = {
						age >= 16 #You are at least 16
						AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
							age < 16
							age >= 12
							#Youngest knight was Daemon Blackfyre
							prowess >= extremely_high_skill_rating
						}
					}
				}
			}

			NOR = {
				has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
				has_trait = maester_historical
			}
			NOT = {
				has_council_position = kingsguard_lord_commander
				primary_title ?= title:d_kingsguard
			}
			NOT = { any_spouse = { is_ruler = yes } }
			NOR = {
				has_trait = bastard
				AND = {
					has_trait = legitimized_bastard
					OR = {
						has_inactive_trait = surname_flowers
						has_inactive_trait = surname_hill
						has_inactive_trait = surname_pyke
						has_inactive_trait = surname_rivers
						has_inactive_trait = surname_sand
						has_inactive_trait = surname_snow
						has_inactive_trait = surname_stone
						has_inactive_trait = surname_storm
						has_inactive_trait = surname_waters
					}
				}
			}
			NOT = { has_trait = silent_sister }
			NOR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
			}

			#Princes/Princesses
			NOR = {
				father ?= {
					primary_title.tier >= tier_kingdom
					OR = {
						AND = {
							primary_title.holder ?= {
								exists = yes
							}
							primary_title ?= title:k_dragonstone
							dynasty ?= dynasty:dynn_Targaryen
							agot_is_independent_ruler = no
						}
						primary_title.holder ?= {
							exists = yes
							OR = {
								agot_is_independent_ruler = yes
								vassal_contract_has_flag = has_palatinate_contract
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
					NOR = {
						government_has_flag = government_is_free_city
						has_government = administrative_government
						has_government = landless_adventurer_government
					}
				}
				mother ?= {
					primary_title.tier >= tier_kingdom
					OR = {
						AND = {
							primary_title.holder ?= {
								exists = yes
							}
							primary_title ?= title:k_dragonstone
							dynasty ?= dynasty:dynn_Targaryen
						}
						primary_title.holder ?= {
							exists = yes
							OR = {
								agot_is_independent_ruler = yes
								vassal_contract_has_flag = has_palatinate_contract
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
					NOR = {
						government_has_flag = government_is_free_city
						has_government = administrative_government
						has_government = landless_adventurer_government
					}
				}
			}
		}
		localization_key = agot_knight_name_long_me
	}

	text = {
		trigger = {
			is_local_player = no
			OR = {
				has_trait = bastard
				AND = {
					has_trait = legitimized_bastard
					OR = {
						has_inactive_trait = surname_flowers
						has_inactive_trait = surname_hill
						has_inactive_trait = surname_pyke
						has_inactive_trait = surname_rivers
						has_inactive_trait = surname_sand
						has_inactive_trait = surname_snow
						has_inactive_trait = surname_stone
						has_inactive_trait = surname_storm
						has_inactive_trait = surname_waters
					}
				}
			}
			NOR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
			}
			NOT = { has_council_position = kingsguard_lord_commander}
			NOT = { any_spouse = { is_ruler = yes } }
			NOT = { has_trait = silent_sister }
			NOT = {
				OR = {
					has_trait = knight
					AND = {
						has_trait_xp = {
							trait = squire
							track = knight
							value >= 100
						}
						OR = {
							age >= 16 #You are at least 16
							AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
								age < 16
								age >= 12
								#Youngest knight was Daemon Blackfyre
								prowess >= extremely_high_skill_rating
							}
						}
					}
				}
				OR = {
					has_trait = maester
					has_trait = maester_historical
				}
			}
		}
		localization_key = agot_bastard_name_long_me
	}
	text = {
		trigger = {
			is_local_player = no
			OR = {
				has_trait = bastard
				AND = {
					has_trait = legitimized_bastard
					OR = {
						has_inactive_trait = surname_flowers
						has_inactive_trait = surname_hill
						has_inactive_trait = surname_pyke
						has_inactive_trait = surname_rivers
						has_inactive_trait = surname_sand
						has_inactive_trait = surname_snow
						has_inactive_trait = surname_stone
						has_inactive_trait = surname_storm
						has_inactive_trait = surname_waters
					}
				}
			}
			NOT = { has_trait = silent_sister }
			OR = {
				has_trait = knight
				AND = {
					has_trait_xp = {
						trait = squire
						track = knight
						value >= 100
					}
					OR = {
						age >= 16 #You are at least 16
						AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
							age < 16
							age >= 12
							#Youngest knight was Daemon Blackfyre
							prowess >= extremely_high_skill_rating
						}
					}
				}
			}
			NOR = {
				has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
				has_trait = maester_historical
			}
			NOT = { has_council_position = kingsguard_lord_commander}
			NOT = { any_spouse = { is_ruler = yes } }
			NOR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
			}
		}
		localization_key = agot_knight_bastard_name_long_me
	}
	text = {
		trigger = {
			is_local_player = no
			OR = {
				has_trait = maester
				has_trait = maester_historical
			}
			is_ruler = no
		}
		localization_key = agot_maester_name_long_me
	}
	text = {
		trigger = {
			is_local_player = no
			OR = {
				has_trait = silent_sister
				is_ruler = no
			}
			is_ruler = no
		}
		localization_key = agot_silent_sister_name_long_me
	}
	text = {
		trigger = {
			is_local_player = no
			has_title = title:k_the_most_devout
		}
		localization_key = agot_high_septon_name_long_me
	}
	text = {
		trigger = {
			is_local_player = no
		}
		fallback = yes
		localization_key = agot_regular_long_name #Necessary since things might break
	}
}

AGOTCustomGetTitledFullNameDynasty = {
	type = character
	log_loc_errors = no
	text = {
		trigger = {
			OR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
				any_spouse = {
					is_ruler = yes
				}
				any_spouse = {
					primary_title.tier >= tier_barony
				}

				father ?= {
					primary_title.tier >= tier_kingdom
					primary_title.holder ?= {
						exists = yes
						NOR = {
							government_has_flag = government_is_free_city
							has_government = administrative_government
							has_government = landless_adventurer_government
						}
					}
					NOR = {
						government_has_flag = government_is_free_city
						has_government = administrative_government
						has_government = landless_adventurer_government
					}
				}
				AND = {
					mother ?= {
						primary_title.tier >= tier_kingdom
						primary_title.holder ?= {
							exists = yes
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
						NOR = {
							government_has_flag = government_is_free_city
							has_government = administrative_government
							has_government = landless_adventurer_government
						}
					}
					trigger_if = { #For when a husband is landless
						limit = {
							father ?= {
								primary_title.tier >= tier_barony
								primary_title.tier >= root.mother.primary_title.tier
							}
						}
						father ?= {
							primary_title.holder ?= {
								exists = yes
								NOR = {
									government_has_flag = government_is_free_city
									has_government = administrative_government
									has_government = landless_adventurer_government
									primary_title.tier < tier_kingdom
								}
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
				}
				is_lowborn = yes
			}
			NOR = {
				has_title = title:k_the_most_devout
				AND = {
					has_trait = silent_sister
					is_ruler = no
				}
				AND = {
					OR = {
						has_trait = maester
						has_trait = maester_historical
					}
					is_ruler = no
				}
				AND = {
					OR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOT = { has_trait = silent_sister }
					OR = {
						has_trait = knight
						AND = {
							has_trait_xp = {
								trait = squire
								track = knight
								value >= 100
							}
							OR = {
								age >= 16 #You are at least 16
								AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
									age < 16
									age >= 12
									#Youngest knight was Daemon Blackfyre
									prowess >= extremely_high_skill_rating
								}
							}
						}
					}
					NOR = {
						has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
						has_trait = maester_historical
					}
					NOT = { has_council_position = kingsguard_lord_commander}
					NOT = { any_spouse = { is_ruler = yes } }
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
				}
				AND = {
					OR = {
						has_trait = knight
						AND = {
							has_trait_xp = {
								trait = squire
								track = knight
								value >= 100
							}
							OR = {
								age >= 16 #You are at least 16
								AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
									age < 16
									age >= 12
									#Youngest knight was Daemon Blackfyre
									prowess >= extremely_high_skill_rating
								}
							}
						}
					}

					NOR = {
						has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
						has_trait = maester_historical
					}
					NOT = {
						has_council_position = kingsguard_lord_commander
						primary_title ?= title:d_kingsguard
					}
					NOT = { any_spouse = { is_ruler = yes } }
					NOR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOT = { has_trait = silent_sister }
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
						father ?= {
							primary_title.tier >= tier_kingdom
							OR = {
								AND = {
									primary_title.holder ?= {
										exists = yes
									}
									primary_title ?= title:k_dragonstone
									dynasty ?= dynasty:dynn_Targaryen
									agot_is_independent_ruler = no
								}
								primary_title.holder ?= {
									exists = yes
									OR = {
										agot_is_independent_ruler = yes
										vassal_contract_has_flag = has_palatinate_contract
									}
									NOR = {
										government_has_flag = government_is_free_city
										has_government = administrative_government
										has_government = landless_adventurer_government
									}
								}
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
						mother ?= {
							primary_title.tier >= tier_kingdom
							OR = {
								AND = {
									primary_title.holder ?= {
										exists = yes
									}
									primary_title ?= title:k_dragonstone
									dynasty ?= dynasty:dynn_Targaryen
									agot_is_independent_ruler = no
								}
								primary_title.holder ?= {
									exists = yes
									OR = {
										agot_is_independent_ruler = yes
										vassal_contract_has_flag = has_palatinate_contract
									}
									NOR = {
										government_has_flag = government_is_free_city
										has_government = administrative_government
										has_government = landless_adventurer_government
									}
								}
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
				}
				AND = {
					OR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
					NOT = { has_council_position = kingsguard_lord_commander}
					NOT = { any_spouse = { is_ruler = yes } }
					NOT = { has_trait = silent_sister }
					NOT = {
						OR = {
							has_trait = knight
							AND = {
								has_trait_xp = {
									trait = squire
									track = knight
									value >= 100
								}
								OR = {
									age >= 16 #You are at least 16
									AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
										age < 16
										age >= 12
										#Youngest knight was Daemon Blackfyre
										prowess >= extremely_high_skill_rating
									}
								}
							}
						}
						OR = {
							has_trait = maester
							has_trait = maester_historical
						}
					}
				}
			}
			exists = this
		}
		localization_key = agot_landed_titled_full_name
	}

	text = {
		trigger = {
			NOR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
				any_spouse = {
					is_ruler = yes
				}
				any_spouse = {
					primary_title.tier >= tier_barony
				}

				father ?= {
					primary_title.tier >= tier_kingdom
					primary_title.holder ?= {
						exists = yes
						NOR = {
							government_has_flag = government_is_free_city
							has_government = administrative_government
							has_government = landless_adventurer_government
						}
					}
					NOR = {
						government_has_flag = government_is_free_city
						has_government = administrative_government
						has_government = landless_adventurer_government
					}
				}
				AND = {
					mother ?= {
						primary_title.tier >= tier_kingdom
						primary_title.holder ?= {
							exists = yes
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
						NOR = {
							government_has_flag = government_is_free_city
							has_government = administrative_government
							has_government = landless_adventurer_government
						}
					}
					trigger_if = { #For when a husband is landless
						limit = {
							father ?= {
								primary_title.tier >= tier_barony
								primary_title.tier >= root.mother.primary_title.tier
							}
						}
						father ?= {
							primary_title.holder ?= {
								exists = yes
								NOR = {
									government_has_flag = government_is_free_city
									has_government = administrative_government
									has_government = landless_adventurer_government
									primary_title.tier < tier_kingdom
								}
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
				}
				is_lowborn = yes
			}
			NOR = {
				has_title = title:k_the_most_devout
				AND = {
					has_trait = silent_sister
					is_ruler = no
				}
				AND = {
					OR = {
						has_trait = maester
						has_trait = maester_historical
					}
					is_ruler = no
				}
				AND = {
					OR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOT = { has_trait = silent_sister }
					OR = {
						has_trait = knight
						AND = {
							has_trait_xp = {
								trait = squire
								track = knight
								value >= 100
							}
							OR = {
								age >= 16 #You are at least 16
								AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
									age < 16
									age >= 12
									#Youngest knight was Daemon Blackfyre
									prowess >= extremely_high_skill_rating
								}
							}
						}
					}
					NOR = {
						has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
						has_trait = maester_historical
					}
					NOT = { has_council_position = kingsguard_lord_commander}
					NOT = { any_spouse = { is_ruler = yes } }
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
				}
				AND = {
					OR = {
						has_trait = knight
						AND = {
							has_trait_xp = {
								trait = squire
								track = knight
								value >= 100
							}
							OR = {
								age >= 16 #You are at least 16
								AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
									age < 16
									age >= 12
									#Youngest knight was Daemon Blackfyre
									prowess >= extremely_high_skill_rating
								}
							}
						}
					}

					NOR = {
						has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
						has_trait = maester_historical
					}
					NOT = {
						has_council_position = kingsguard_lord_commander
						primary_title ?= title:d_kingsguard
					}
					NOT = { any_spouse = { is_ruler = yes } }
					NOR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOT = { has_trait = silent_sister }
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
				}
				AND = {
					OR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
					NOT = { has_council_position = kingsguard_lord_commander}
					NOT = { any_spouse = { is_ruler = yes } }
					NOT = { has_trait = silent_sister }
					NOT = {
						OR = {
							has_trait = knight
							AND = {
								has_trait_xp = {
									trait = squire
									track = knight
									value >= 100
								}
								OR = {
									age >= 16 #You are at least 16
									AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
										age < 16
										age >= 12
										#Youngest knight was Daemon Blackfyre
										prowess >= extremely_high_skill_rating
									}
								}
							}
						}
						OR = {
							has_trait = maester
							has_trait = maester_historical
						}
					}
				}
			}
			exists = this
		}
		localization_key = agot_unlanded_titled_full_name
	}

	text = {
		trigger = {
			OR = {
				has_trait = knight
				AND = {
					has_trait_xp = {
						trait = squire
						track = knight
						value >= 100
					}
					OR = {
						age >= 16 #You are at least 16
						AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
							age < 16
							age >= 12
							#Youngest knight was Daemon Blackfyre
							prowess >= extremely_high_skill_rating
						}
					}
				}
			}

			NOR = {
				has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
				has_trait = maester_historical
			}
			NOT = {
				has_council_position = kingsguard_lord_commander
				primary_title ?= title:d_kingsguard
			}
			NOT = { any_spouse = { is_ruler = yes } }
			NOR = {
				has_trait = bastard
				AND = {
					has_trait = legitimized_bastard
					OR = {
						has_inactive_trait = surname_flowers
						has_inactive_trait = surname_hill
						has_inactive_trait = surname_pyke
						has_inactive_trait = surname_rivers
						has_inactive_trait = surname_sand
						has_inactive_trait = surname_snow
						has_inactive_trait = surname_stone
						has_inactive_trait = surname_storm
						has_inactive_trait = surname_waters
					}
				}
			}
			NOT = { has_trait = silent_sister }
			NOR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
			}

			#Princes/Princesses
			NOR = {
				father ?= {
					primary_title.tier >= tier_kingdom
					OR = {
						AND = {
							primary_title.holder ?= {
								exists = yes
							}
							primary_title ?= title:k_dragonstone
							dynasty ?= dynasty:dynn_Targaryen
							agot_is_independent_ruler = no
						}
						primary_title.holder ?= {
							exists = yes
							OR = {
								agot_is_independent_ruler = yes
								vassal_contract_has_flag = has_palatinate_contract
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
					NOR = {
						government_has_flag = government_is_free_city
						has_government = administrative_government
						has_government = landless_adventurer_government
					}
				}
				mother ?= {
					primary_title.tier >= tier_kingdom
					OR = {
						AND = {
							primary_title.holder ?= {
								exists = yes
							}
							primary_title ?= title:k_dragonstone
							dynasty ?= dynasty:dynn_Targaryen
						}
						primary_title.holder ?= {
							exists = yes
							OR = {
								agot_is_independent_ruler = yes
								vassal_contract_has_flag = has_palatinate_contract
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
					NOR = {
						government_has_flag = government_is_free_city
						has_government = administrative_government
						has_government = landless_adventurer_government
					}
				}
			}
			exists = this
		}
		localization_key = agot_knight_titled_full_name
	}

	text = {
		trigger = {
			OR = {
				has_trait = bastard
				AND = {
					has_trait = legitimized_bastard
					OR = {
						has_inactive_trait = surname_flowers
						has_inactive_trait = surname_hill
						has_inactive_trait = surname_pyke
						has_inactive_trait = surname_rivers
						has_inactive_trait = surname_sand
						has_inactive_trait = surname_snow
						has_inactive_trait = surname_stone
						has_inactive_trait = surname_storm
						has_inactive_trait = surname_waters
					}
				}
			}
			NOR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
			}
			NOT = { has_council_position = kingsguard_lord_commander}
			NOT = { any_spouse = { is_ruler = yes } }
			NOT = { has_trait = silent_sister }
			NOT = {
				OR = {
					has_trait = knight
					AND = {
						has_trait_xp = {
							trait = squire
							track = knight
							value >= 100
						}
						OR = {
							age >= 16 #You are at least 16
							AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
								age < 16
								age >= 12
								#Youngest knight was Daemon Blackfyre
								prowess >= extremely_high_skill_rating
							}
						}
					}
				}
				OR = {
					has_trait = maester
					has_trait = maester_historical
				}
			}
			exists = this
		}
		localization_key = agot_bastard_titled_full_name
	}
	text = {
		trigger = {
			OR = {
				has_trait = bastard
				AND = {
					has_trait = legitimized_bastard
					OR = {
						has_inactive_trait = surname_flowers
						has_inactive_trait = surname_hill
						has_inactive_trait = surname_pyke
						has_inactive_trait = surname_rivers
						has_inactive_trait = surname_sand
						has_inactive_trait = surname_snow
						has_inactive_trait = surname_stone
						has_inactive_trait = surname_storm
						has_inactive_trait = surname_waters
					}
				}
			}
			NOT = { has_trait = silent_sister }
			OR = {
				has_trait = knight
				AND = {
					has_trait_xp = {
						trait = squire
						track = knight
						value >= 100
					}
					OR = {
						age >= 16 #You are at least 16
						AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
							age < 16
							age >= 12
							#Youngest knight was Daemon Blackfyre
							prowess >= extremely_high_skill_rating
						}
					}
				}
			}
			NOR = {
				has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
				has_trait = maester_historical
			}
			NOT = { has_council_position = kingsguard_lord_commander}
			NOT = { any_spouse = { is_ruler = yes } }
			NOR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
			}
			exists = this
		}
		localization_key = agot_knight_bastard_titled_full_name
	}
	text = {
		trigger = {
			OR = {
				has_trait = maester
				has_trait = maester_historical
			}
			is_ruler = no
			exists = this
		}
		localization_key = agot_maester_titled_full_name
	}
	text = {
		trigger = {
			OR = {
				has_trait = silent_sister
				is_ruler = no
			}
			exists = this
			is_ruler = no
		}
		localization_key = agot_silent_sister_titled_full_name
	}
	text = {
		trigger = {
			has_title = title:k_the_most_devout
			exists = this
		}
		localization_key = agot_high_septon_titled_full_name
	}
	text = {
		trigger = {
			exists = this
		}
		fallback = yes
		localization_key = agot_regular_titled_full_name #Necessary since things might break
	}
}

AGOTCustomGetTitledFirstName = {
	type = character
	log_loc_errors = no
	text = {
		trigger = {
			OR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
				any_spouse = {
					is_ruler = yes
				}
				any_spouse = {
					primary_title.tier >= tier_barony
				}

				father ?= {
					primary_title.tier >= tier_kingdom
					primary_title.holder ?= {
						exists = yes
						NOR = {
							government_has_flag = government_is_free_city
							has_government = administrative_government
							has_government = landless_adventurer_government
						}
					}
					NOR = {
						government_has_flag = government_is_free_city
						has_government = administrative_government
						has_government = landless_adventurer_government
					}
				}
				AND = {
					mother ?= {
						primary_title.tier >= tier_kingdom
						primary_title.holder ?= {
							exists = yes
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
						NOR = {
							government_has_flag = government_is_free_city
							has_government = administrative_government
							has_government = landless_adventurer_government
						}
					}
					trigger_if = { #For when a husband is landless
						limit = {
							father ?= {
								primary_title.tier >= tier_barony
								primary_title.tier >= root.mother.primary_title.tier
							}
						}
						father ?= {
							primary_title.holder ?= {
								exists = yes
								NOR = {
									government_has_flag = government_is_free_city
									has_government = administrative_government
									has_government = landless_adventurer_government
									primary_title.tier < tier_kingdom
								}
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
				}
				is_lowborn = yes
			}
			NOR = {
				has_title = title:k_the_most_devout
				AND = {
					has_trait = silent_sister
					is_ruler = no
				}
				AND = {
					OR = {
						has_trait = maester
						has_trait = maester_historical
					}
					is_ruler = no
				}
				AND = {
					OR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOT = { has_trait = silent_sister }
					OR = {
						has_trait = knight
						AND = {
							has_trait_xp = {
								trait = squire
								track = knight
								value >= 100
							}
							OR = {
								age >= 16 #You are at least 16
								AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
									age < 16
									age >= 12
									#Youngest knight was Daemon Blackfyre
									prowess >= extremely_high_skill_rating
								}
							}
						}
					}
					NOR = {
						has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
						has_trait = maester_historical
					}
					NOT = { has_council_position = kingsguard_lord_commander}
					NOT = { any_spouse = { is_ruler = yes } }
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
				}
				AND = {
					OR = {
						has_trait = knight
						AND = {
							has_trait_xp = {
								trait = squire
								track = knight
								value >= 100
							}
							OR = {
								age >= 16 #You are at least 16
								AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
									age < 16
									age >= 12
									#Youngest knight was Daemon Blackfyre
									prowess >= extremely_high_skill_rating
								}
							}
						}
					}

					NOR = {
						has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
						has_trait = maester_historical
					}
					NOT = {
						has_council_position = kingsguard_lord_commander
						primary_title ?= title:d_kingsguard
					}
					NOT = { any_spouse = { is_ruler = yes } }
					NOR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOT = { has_trait = silent_sister }
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
						father ?= {
							primary_title.tier >= tier_kingdom
							OR = {
								AND = {
									primary_title.holder ?= {
										exists = yes
									}
									primary_title ?= title:k_dragonstone
									dynasty ?= dynasty:dynn_Targaryen
									agot_is_independent_ruler = no
								}
								primary_title.holder ?= {
									exists = yes
									OR = {
										agot_is_independent_ruler = yes
										vassal_contract_has_flag = has_palatinate_contract
									}
									NOR = {
										government_has_flag = government_is_free_city
										has_government = administrative_government
										has_government = landless_adventurer_government
									}
								}
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
						mother ?= {
							primary_title.tier >= tier_kingdom
							OR = {
								AND = {
									primary_title.holder ?= {
										exists = yes
									}
									primary_title ?= title:k_dragonstone
									dynasty ?= dynasty:dynn_Targaryen
									agot_is_independent_ruler = no
								}
								primary_title.holder ?= {
									exists = yes
									OR = {
										agot_is_independent_ruler = yes
										vassal_contract_has_flag = has_palatinate_contract
									}
									NOR = {
										government_has_flag = government_is_free_city
										has_government = administrative_government
										has_government = landless_adventurer_government
									}
								}
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
				}
				AND = {
					OR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
					NOT = { has_council_position = kingsguard_lord_commander}
					NOT = { any_spouse = { is_ruler = yes } }
					NOT = { has_trait = silent_sister }
					NOT = {
						OR = {
							has_trait = knight
							AND = {
								has_trait_xp = {
									trait = squire
									track = knight
									value >= 100
								}
								OR = {
									age >= 16 #You are at least 16
									AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
										age < 16
										age >= 12
										#Youngest knight was Daemon Blackfyre
										prowess >= extremely_high_skill_rating
									}
								}
							}
						}
						OR = {
							has_trait = maester
							has_trait = maester_historical
						}
					}
				}
			}
		}
		localization_key = agot_landed_titled_first_name
	}

	text = {
		trigger = {
			NOR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
				any_spouse = {
					is_ruler = yes
				}
				any_spouse = {
					primary_title.tier >= tier_barony
				}

				father ?= {
					primary_title.tier >= tier_kingdom
					primary_title.holder ?= {
						exists = yes
						NOR = {
							government_has_flag = government_is_free_city
							has_government = administrative_government
							has_government = landless_adventurer_government
						}
					}
					NOR = {
						government_has_flag = government_is_free_city
						has_government = administrative_government
						has_government = landless_adventurer_government
					}
				}
				AND = {
					mother ?= {
						primary_title.tier >= tier_kingdom
						primary_title.holder ?= {
							exists = yes
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
						NOR = {
							government_has_flag = government_is_free_city
							has_government = administrative_government
							has_government = landless_adventurer_government
						}
					}
					trigger_if = { #For when a husband is landless
						limit = {
							father ?= {
								primary_title.tier >= tier_barony
								primary_title.tier >= root.mother.primary_title.tier
							}
						}
						father ?= {
							primary_title.holder ?= {
								exists = yes
								NOR = {
									government_has_flag = government_is_free_city
									has_government = administrative_government
									has_government = landless_adventurer_government
									primary_title.tier < tier_kingdom
								}
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
				}
				is_lowborn = yes
			}
			NOR = {
				has_title = title:k_the_most_devout
				AND = {
					has_trait = silent_sister
					is_ruler = no
				}
				AND = {
					OR = {
						has_trait = maester
						has_trait = maester_historical
					}
					is_ruler = no
				}
				AND = {
					OR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOT = { has_trait = silent_sister }
					OR = {
						has_trait = knight
						AND = {
							has_trait_xp = {
								trait = squire
								track = knight
								value >= 100
							}
							OR = {
								age >= 16 #You are at least 16
								AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
									age < 16
									age >= 12
									#Youngest knight was Daemon Blackfyre
									prowess >= extremely_high_skill_rating
								}
							}
						}
					}
					NOR = {
						has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
						has_trait = maester_historical
					}
					NOT = { has_council_position = kingsguard_lord_commander}
					NOT = { any_spouse = { is_ruler = yes } }
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
				}
				AND = {
					OR = {
						has_trait = knight
						AND = {
							has_trait_xp = {
								trait = squire
								track = knight
								value >= 100
							}
							OR = {
								age >= 16 #You are at least 16
								AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
									age < 16
									age >= 12
									#Youngest knight was Daemon Blackfyre
									prowess >= extremely_high_skill_rating
								}
							}
						}
					}

					NOR = {
						has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
						has_trait = maester_historical
					}
					NOT = {
						has_council_position = kingsguard_lord_commander
						primary_title ?= title:d_kingsguard
					}
					NOT = { any_spouse = { is_ruler = yes } }
					NOR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOT = { has_trait = silent_sister }
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
				}
				AND = {
					OR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
					NOT = { has_council_position = kingsguard_lord_commander}
					NOT = { any_spouse = { is_ruler = yes } }
					NOT = { has_trait = silent_sister }
					NOT = {
						OR = {
							has_trait = knight
							AND = {
								has_trait_xp = {
									trait = squire
									track = knight
									value >= 100
								}
								OR = {
									age >= 16 #You are at least 16
									AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
										age < 16
										age >= 12
										#Youngest knight was Daemon Blackfyre
										prowess >= extremely_high_skill_rating
									}
								}
							}
						}
						OR = {
							has_trait = maester
							has_trait = maester_historical
						}
					}
				}
			}
		}
		localization_key = agot_unlanded_titled_first_name
	}

	text = {
		trigger = {
			OR = {
				has_trait = knight
				AND = {
					has_trait_xp = {
						trait = squire
						track = knight
						value >= 100
					}
					OR = {
						age >= 16 #You are at least 16
						AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
							age < 16
							age >= 12
							#Youngest knight was Daemon Blackfyre
							prowess >= extremely_high_skill_rating
						}
					}
				}
			}

			NOR = {
				has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
				has_trait = maester_historical
			}
			NOT = {
				has_council_position = kingsguard_lord_commander
				primary_title ?= title:d_kingsguard
			}
			NOT = { any_spouse = { is_ruler = yes } }
			NOR = {
				has_trait = bastard
				AND = {
					has_trait = legitimized_bastard
					OR = {
						has_inactive_trait = surname_flowers
						has_inactive_trait = surname_hill
						has_inactive_trait = surname_pyke
						has_inactive_trait = surname_rivers
						has_inactive_trait = surname_sand
						has_inactive_trait = surname_snow
						has_inactive_trait = surname_stone
						has_inactive_trait = surname_storm
						has_inactive_trait = surname_waters
					}
				}
			}
			NOT = { has_trait = silent_sister }
			NOR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
			}

			#Princes/Princesses
			NOR = {
				father ?= {
					primary_title.tier >= tier_kingdom
					OR = {
						AND = {
							primary_title.holder ?= {
								exists = yes
							}
							primary_title ?= title:k_dragonstone
							dynasty ?= dynasty:dynn_Targaryen
							agot_is_independent_ruler = no
						}
						primary_title.holder ?= {
							exists = yes
							OR = {
								agot_is_independent_ruler = yes
								vassal_contract_has_flag = has_palatinate_contract
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
					NOR = {
						government_has_flag = government_is_free_city
						has_government = administrative_government
						has_government = landless_adventurer_government
					}
				}
				mother ?= {
					primary_title.tier >= tier_kingdom
					OR = {
						AND = {
							primary_title.holder ?= {
								exists = yes
							}
							primary_title ?= title:k_dragonstone
							dynasty ?= dynasty:dynn_Targaryen
						}
						primary_title.holder ?= {
							exists = yes
							OR = {
								agot_is_independent_ruler = yes
								vassal_contract_has_flag = has_palatinate_contract
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
					NOR = {
						government_has_flag = government_is_free_city
						has_government = administrative_government
						has_government = landless_adventurer_government
					}
				}
			}
		}
		localization_key = agot_knight_titled_first_name
	}

	text = {
		trigger = {
			OR = {
				has_trait = bastard
				AND = {
					has_trait = legitimized_bastard
					OR = {
						has_inactive_trait = surname_flowers
						has_inactive_trait = surname_hill
						has_inactive_trait = surname_pyke
						has_inactive_trait = surname_rivers
						has_inactive_trait = surname_sand
						has_inactive_trait = surname_snow
						has_inactive_trait = surname_stone
						has_inactive_trait = surname_storm
						has_inactive_trait = surname_waters
					}
				}
			}
			NOR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
			}
			NOT = { has_council_position = kingsguard_lord_commander}
			NOT = { any_spouse = { is_ruler = yes } }
			NOT = { has_trait = silent_sister }
			NOT = {
				OR = {
					has_trait = knight
					AND = {
						has_trait_xp = {
							trait = squire
							track = knight
							value >= 100
						}
						OR = {
							age >= 16 #You are at least 16
							AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
								age < 16
								age >= 12
								#Youngest knight was Daemon Blackfyre
								prowess >= extremely_high_skill_rating
							}
						}
					}
				}
				OR = {
					has_trait = maester
					has_trait = maester_historical
				}
			}
		}
		localization_key = agot_bastard_titled_first_name
	}
	text = {
		trigger = {
			OR = {
				has_trait = bastard
				AND = {
					has_trait = legitimized_bastard
					OR = {
						has_inactive_trait = surname_flowers
						has_inactive_trait = surname_hill
						has_inactive_trait = surname_pyke
						has_inactive_trait = surname_rivers
						has_inactive_trait = surname_sand
						has_inactive_trait = surname_snow
						has_inactive_trait = surname_stone
						has_inactive_trait = surname_storm
						has_inactive_trait = surname_waters
					}
				}
			}
			NOT = { has_trait = silent_sister }
			OR = {
				has_trait = knight
				AND = {
					has_trait_xp = {
						trait = squire
						track = knight
						value >= 100
					}
					OR = {
						age >= 16 #You are at least 16
						AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
							age < 16
							age >= 12
							#Youngest knight was Daemon Blackfyre
							prowess >= extremely_high_skill_rating
						}
					}
				}
			}
			NOR = {
				has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
				has_trait = maester_historical
			}
			NOT = { has_council_position = kingsguard_lord_commander}
			NOT = { any_spouse = { is_ruler = yes } }
			NOR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
			}
		}
		localization_key = agot_knight_bastard_titled_first_name
	}
	text = {
		trigger = {
			OR = {
				has_trait = maester
				has_trait = maester_historical
			}
			is_ruler = no
		}
		localization_key = agot_maester_titled_first_name
	}
	text = {
		trigger = {
			OR = {
				has_trait = silent_sister
				is_ruler = no
			}
			is_ruler = no
		}
		localization_key = agot_silent_sister_titled_first_name
	}
	text = {
		trigger = {
			has_title = title:k_the_most_devout
		}
		localization_key = agot_high_septon_titled_first_name
	}
	text = {
		fallback = yes
		localization_key = agot_regular_titled_full_name #Necessary since things might break
	}
}

AGOTCustomGetTitledFirstNamePossessive = {
	type = character
	log_loc_errors = no
	text = {
		trigger = {
			OR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
				any_spouse = {
					is_ruler = yes
				}
				any_spouse = {
					primary_title.tier >= tier_barony
				}

				father ?= {
					primary_title.tier >= tier_kingdom
					primary_title.holder ?= {
						exists = yes
						NOR = {
							government_has_flag = government_is_free_city
							has_government = administrative_government
							has_government = landless_adventurer_government
						}
					}
					NOR = {
						government_has_flag = government_is_free_city
						has_government = administrative_government
						has_government = landless_adventurer_government
					}
				}
				AND = {
					mother ?= {
						primary_title.tier >= tier_kingdom
						primary_title.holder ?= {
							exists = yes
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
						NOR = {
							government_has_flag = government_is_free_city
							has_government = administrative_government
							has_government = landless_adventurer_government
						}
					}
					trigger_if = { #For when a husband is landless
						limit = {
							father ?= {
								primary_title.tier >= tier_barony
								primary_title.tier >= root.mother.primary_title.tier
							}
						}
						father ?= {
							primary_title.holder ?= {
								exists = yes
								NOR = {
									government_has_flag = government_is_free_city
									has_government = administrative_government
									has_government = landless_adventurer_government
									primary_title.tier < tier_kingdom
								}
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
				}
				is_lowborn = yes
			}
			NOR = {
				has_title = title:k_the_most_devout
				AND = {
					has_trait = silent_sister
					is_ruler = no
				}
				AND = {
					OR = {
						has_trait = maester
						has_trait = maester_historical
					}
					is_ruler = no
				}
				AND = {
					OR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOT = { has_trait = silent_sister }
					OR = {
						has_trait = knight
						AND = {
							has_trait_xp = {
								trait = squire
								track = knight
								value >= 100
							}
							OR = {
								age >= 16 #You are at least 16
								AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
									age < 16
									age >= 12
									#Youngest knight was Daemon Blackfyre
									prowess >= extremely_high_skill_rating
								}
							}
						}
					}
					NOR = {
						has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
						has_trait = maester_historical
					}
					NOT = { has_council_position = kingsguard_lord_commander}
					NOT = { any_spouse = { is_ruler = yes } }
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
				}
				AND = {
					OR = {
						has_trait = knight
						AND = {
							has_trait_xp = {
								trait = squire
								track = knight
								value >= 100
							}
							OR = {
								age >= 16 #You are at least 16
								AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
									age < 16
									age >= 12
									#Youngest knight was Daemon Blackfyre
									prowess >= extremely_high_skill_rating
								}
							}
						}
					}

					NOR = {
						has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
						has_trait = maester_historical
					}
					NOT = {
						has_council_position = kingsguard_lord_commander
						primary_title ?= title:d_kingsguard
					}
					NOT = { any_spouse = { is_ruler = yes } }
					NOR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOT = { has_trait = silent_sister }
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
						father ?= {
							primary_title.tier >= tier_kingdom
							OR = {
								AND = {
									primary_title.holder ?= {
										exists = yes
									}
									primary_title ?= title:k_dragonstone
									dynasty ?= dynasty:dynn_Targaryen
									agot_is_independent_ruler = no
								}
								primary_title.holder ?= {
									exists = yes
									OR = {
										agot_is_independent_ruler = yes
										vassal_contract_has_flag = has_palatinate_contract
									}
									NOR = {
										government_has_flag = government_is_free_city
										has_government = administrative_government
										has_government = landless_adventurer_government
									}
								}
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
						mother ?= {
							primary_title.tier >= tier_kingdom
							OR = {
								AND = {
									primary_title.holder ?= {
										exists = yes
									}
									primary_title ?= title:k_dragonstone
									dynasty ?= dynasty:dynn_Targaryen
									agot_is_independent_ruler = no
								}
								primary_title.holder ?= {
									exists = yes
									OR = {
										agot_is_independent_ruler = yes
										vassal_contract_has_flag = has_palatinate_contract
									}
									NOR = {
										government_has_flag = government_is_free_city
										has_government = administrative_government
										has_government = landless_adventurer_government
									}
								}
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
				}
				AND = {
					OR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
					NOT = { has_council_position = kingsguard_lord_commander}
					NOT = { any_spouse = { is_ruler = yes } }
					NOT = { has_trait = silent_sister }
					NOT = {
						OR = {
							has_trait = knight
							AND = {
								has_trait_xp = {
									trait = squire
									track = knight
									value >= 100
								}
								OR = {
									age >= 16 #You are at least 16
									AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
										age < 16
										age >= 12
										#Youngest knight was Daemon Blackfyre
										prowess >= extremely_high_skill_rating
									}
								}
							}
						}
						OR = {
							has_trait = maester
							has_trait = maester_historical
						}
					}
				}
			}
		}
		localization_key = agot_landed_titled_first_name_possessive
	}

	text = {
		trigger = {
			NOR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
				any_spouse = {
					is_ruler = yes
				}
				any_spouse = {
					primary_title.tier >= tier_barony
				}

				father ?= {
					primary_title.tier >= tier_kingdom
					primary_title.holder ?= {
						exists = yes
						NOR = {
							government_has_flag = government_is_free_city
							has_government = administrative_government
							has_government = landless_adventurer_government
						}
					}
					NOR = {
						government_has_flag = government_is_free_city
						has_government = administrative_government
						has_government = landless_adventurer_government
					}
				}
				AND = {
					mother ?= {
						primary_title.tier >= tier_kingdom
						primary_title.holder ?= {
							exists = yes
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
						NOR = {
							government_has_flag = government_is_free_city
							has_government = administrative_government
							has_government = landless_adventurer_government
						}
					}
					trigger_if = { #For when a husband is landless
						limit = {
							father ?= {
								primary_title.tier >= tier_barony
								primary_title.tier >= root.mother.primary_title.tier
							}
						}
						father ?= {
							primary_title.holder ?= {
								exists = yes
								NOR = {
									government_has_flag = government_is_free_city
									has_government = administrative_government
									has_government = landless_adventurer_government
									primary_title.tier < tier_kingdom
								}
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
				}
				is_lowborn = yes
			}
			NOR = {
				has_title = title:k_the_most_devout
				AND = {
					has_trait = silent_sister
					is_ruler = no
				}
				AND = {
					OR = {
						has_trait = maester
						has_trait = maester_historical
					}
					is_ruler = no
				}
				AND = {
					OR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOT = { has_trait = silent_sister }
					OR = {
						has_trait = knight
						AND = {
							has_trait_xp = {
								trait = squire
								track = knight
								value >= 100
							}
							OR = {
								age >= 16 #You are at least 16
								AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
									age < 16
									age >= 12
									#Youngest knight was Daemon Blackfyre
									prowess >= extremely_high_skill_rating
								}
							}
						}
					}
					NOR = {
						has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
						has_trait = maester_historical
					}
					NOT = { has_council_position = kingsguard_lord_commander}
					NOT = { any_spouse = { is_ruler = yes } }
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
				}
				AND = {
					OR = {
						has_trait = knight
						AND = {
							has_trait_xp = {
								trait = squire
								track = knight
								value >= 100
							}
							OR = {
								age >= 16 #You are at least 16
								AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
									age < 16
									age >= 12
									#Youngest knight was Daemon Blackfyre
									prowess >= extremely_high_skill_rating
								}
							}
						}
					}

					NOR = {
						has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
						has_trait = maester_historical
					}
					NOT = {
						has_council_position = kingsguard_lord_commander
						primary_title ?= title:d_kingsguard
					}
					NOT = { any_spouse = { is_ruler = yes } }
					NOR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOT = { has_trait = silent_sister }
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
				}
				AND = {
					OR = {
						has_trait = bastard
						AND = {
							has_trait = legitimized_bastard
							OR = {
								has_inactive_trait = surname_flowers
								has_inactive_trait = surname_hill
								has_inactive_trait = surname_pyke
								has_inactive_trait = surname_rivers
								has_inactive_trait = surname_sand
								has_inactive_trait = surname_snow
								has_inactive_trait = surname_stone
								has_inactive_trait = surname_storm
								has_inactive_trait = surname_waters
							}
						}
					}
					NOR = {
						is_ruler = yes
						primary_title.tier >= tier_barony
					}
					NOT = { has_council_position = kingsguard_lord_commander}
					NOT = { any_spouse = { is_ruler = yes } }
					NOT = { has_trait = silent_sister }
					NOT = {
						OR = {
							has_trait = knight
							AND = {
								has_trait_xp = {
									trait = squire
									track = knight
									value >= 100
								}
								OR = {
									age >= 16 #You are at least 16
									AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
										age < 16
										age >= 12
										#Youngest knight was Daemon Blackfyre
										prowess >= extremely_high_skill_rating
									}
								}
							}
						}
						OR = {
							has_trait = maester
							has_trait = maester_historical
						}
					}
				}
			}
		}
		localization_key = agot_unlanded_titled_first_name_possessive
	}

	text = {
		trigger = {
			OR = {
				has_trait = knight
				AND = {
					has_trait_xp = {
						trait = squire
						track = knight
						value >= 100
					}
					OR = {
						age >= 16 #You are at least 16
						AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
							age < 16
							age >= 12
							#Youngest knight was Daemon Blackfyre
							prowess >= extremely_high_skill_rating
						}
					}
				}
			}

			NOR = {
				has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
				has_trait = maester_historical
			}
			NOT = {
				has_council_position = kingsguard_lord_commander
				primary_title ?= title:d_kingsguard
			}
			NOT = { any_spouse = { is_ruler = yes } }
			NOR = {
				has_trait = bastard
				AND = {
					has_trait = legitimized_bastard
					OR = {
						has_inactive_trait = surname_flowers
						has_inactive_trait = surname_hill
						has_inactive_trait = surname_pyke
						has_inactive_trait = surname_rivers
						has_inactive_trait = surname_sand
						has_inactive_trait = surname_snow
						has_inactive_trait = surname_stone
						has_inactive_trait = surname_storm
						has_inactive_trait = surname_waters
					}
				}
			}
			NOT = { has_trait = silent_sister }
			NOR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
			}

			#Princes/Princesses
			NOR = {
				father ?= {
					primary_title.tier >= tier_kingdom
					OR = {
						AND = {
							primary_title.holder ?= {
								exists = yes
							}
							primary_title ?= title:k_dragonstone
							dynasty ?= dynasty:dynn_Targaryen
							agot_is_independent_ruler = no
						}
						primary_title.holder ?= {
							exists = yes
							OR = {
								agot_is_independent_ruler = yes
								vassal_contract_has_flag = has_palatinate_contract
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
					NOR = {
						government_has_flag = government_is_free_city
						has_government = administrative_government
						has_government = landless_adventurer_government
					}
				}
				mother ?= {
					primary_title.tier >= tier_kingdom
					OR = {
						AND = {
							primary_title.holder ?= {
								exists = yes
							}
							primary_title ?= title:k_dragonstone
							dynasty ?= dynasty:dynn_Targaryen
						}
						primary_title.holder ?= {
							exists = yes
							OR = {
								agot_is_independent_ruler = yes
								vassal_contract_has_flag = has_palatinate_contract
							}
							NOR = {
								government_has_flag = government_is_free_city
								has_government = administrative_government
								has_government = landless_adventurer_government
							}
						}
					}
					NOR = {
						government_has_flag = government_is_free_city
						has_government = administrative_government
						has_government = landless_adventurer_government
					}
				}
			}
		}
		localization_key = agot_knight_titled_first_name_possessive
	}

	text = {
		trigger = {
			OR = {
				has_trait = bastard
				AND = {
					has_trait = legitimized_bastard
					OR = {
						has_inactive_trait = surname_flowers
						has_inactive_trait = surname_hill
						has_inactive_trait = surname_pyke
						has_inactive_trait = surname_rivers
						has_inactive_trait = surname_sand
						has_inactive_trait = surname_snow
						has_inactive_trait = surname_stone
						has_inactive_trait = surname_storm
						has_inactive_trait = surname_waters
					}
				}
			}
			NOR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
			}
			NOT = { has_council_position = kingsguard_lord_commander}
			NOT = { any_spouse = { is_ruler = yes } }
			NOT = { has_trait = silent_sister }
			NOT = {
				OR = {
					has_trait = knight
					AND = {
						has_trait_xp = {
							trait = squire
							track = knight
							value >= 100
						}
						OR = {
							age >= 16 #You are at least 16
							AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
								age < 16
								age >= 12
								#Youngest knight was Daemon Blackfyre
								prowess >= extremely_high_skill_rating
							}
						}
					}
				}
				OR = {
					has_trait = maester
					has_trait = maester_historical
				}
			}
		}
		localization_key = agot_bastard_titled_first_name_possessive
	}
	text = {
		trigger = {
			OR = {
				has_trait = bastard
				AND = {
					has_trait = legitimized_bastard
					OR = {
						has_inactive_trait = surname_flowers
						has_inactive_trait = surname_hill
						has_inactive_trait = surname_pyke
						has_inactive_trait = surname_rivers
						has_inactive_trait = surname_sand
						has_inactive_trait = surname_snow
						has_inactive_trait = surname_stone
						has_inactive_trait = surname_storm
						has_inactive_trait = surname_waters
					}
				}
			}
			NOT = { has_trait = silent_sister }
			OR = {
				has_trait = knight
				AND = {
					has_trait_xp = {
						trait = squire
						track = knight
						value >= 100
					}
					OR = {
						age >= 16 #You are at least 16
						AND = { #You are 12 or older and either: your prowess is >= 20; or, your prowess is >=15 and you are a formiddable fighter
							age < 16
							age >= 12
							#Youngest knight was Daemon Blackfyre
							prowess >= extremely_high_skill_rating
						}
					}
				}
			}
			NOR = {
				has_trait = maester #you shouldn't be able to knight maesters anyway but just in case
				has_trait = maester_historical
			}
			NOT = { has_council_position = kingsguard_lord_commander}
			NOT = { any_spouse = { is_ruler = yes } }
			NOR = {
				is_ruler = yes
				primary_title.tier >= tier_barony
			}
		}
		localization_key = agot_knight_bastard_titled_first_name_possessive
	}
	text = {
		trigger = {
			OR = {
				has_trait = maester
				has_trait = maester_historical
			}
			is_ruler = no
		}
		localization_key = agot_maester_titled_first_name_possessive
	}
	text = {
		trigger = {
			OR = {
				has_trait = silent_sister
				is_ruler = no
			}
			is_ruler = no
		}
		localization_key = agot_silent_sister_titled_first_name_possessive
	}
	text = {
		trigger = {
			has_title = title:k_the_most_devout
		}
		localization_key = agot_high_septon_titled_first_name_possessive
	}
	text = {
		fallback = yes
		localization_key = agot_regular_titled_first_name_possessive #Necessary since things might break
	}
}