namespace = agot_crowned_stag

####################
# The Crowned Stag #
####################

agot_crowned_stag.0001 = { # Opening Robert Event
	type = character_event
	title = agot_crowned_stag.0001.t
	desc = agot_crowned_stag.0001.desc
	theme = diplomacy_majesty_focus
	orphan = yes #not actually orphan but triggered in history files
	override_background = {
		reference = agot_iron_throne
	}

	left_portrait = {
		character = root
		animation = personality_bold
	}

	option = {	# Long may I reign.
		name = agot_crowned_stag.0001.a
		add_prestige = 500
		trigger_event = {
			id = agot_crowned_stag.0002
			days = { 360 540 }
		}
	}
}

########################
# The "Royal" Bastards #
########################
#
# On average, Robert sires a bastard a year.

agot_crowned_stag.0002 = { # Go to a brothel?
	type = character_event
	title = agot_crowned_stag.0002.t
	desc = agot_crowned_stag.0002.desc
	theme = party
	override_background = {
		reference = tavern
	}

	left_portrait = {
		character = root
		animation = stress
	}

	option = {	# I could use the company
		name = agot_crowned_stag.0002.a
		trigger_event = {
			id = agot_crowned_stag.0003 # Visit a brothel
		}
		ai_chance = {
			base = 100
		}
	}
	option = {	# I do not need the company!
		name = agot_crowned_stag.0002.b
		trigger_event = {
			id = agot_crowned_stag.0002
			days = { 1080 2160 }
		}
		stress_impact = {
			lustful = medium_stress_impact_gain
		}
		ai_chance = {
			base = 0
		}
	}
}

agot_crowned_stag.0003 = {
	type = character_event
	title = agot_crowned_stag.0003.t
	desc = agot_crowned_stag.0003.desc
	theme = party
	override_background = {
		reference = tavern
	}

	immediate = {
		create_character = {
			age = { 18 32 }
			gender = female
			dynasty = none
			location = province:4155
			random_traits = yes
			faith = faith:fots_seven
			random_culture = {
				culture:crownlander = {
					weight = { base = 5 }
				}
				culture:clawman = {
					weight = { base = 3 }
				}
				culture:reachman = {
					weight = { base = 8 }
				}
				culture:honeywiner = {
					weight = { base = 8 }
				}
				culture:lyseni = {
					weight = { base = 8 }
				}
				culture:riverlander = {
					weight = { base = 5 }
				}
				culture:stone_dornish = {
					weight = { base = 5 }
				}
				culture:salt_dornish = {
					weight = { base = 5 }
				}
				culture:sand_dornish = {
					weight = { base = 5 }
				}
				culture:stormlander = {
					weight = { base = 5 }
				}
				culture:marcher = {
					weight = { base = 5 }
				}
				culture:valeman = {
					weight = { base = 5 }
				}
				culture:myrish = {
					weight = { base = 10 }
				}
				culture:westerman = {
					weight = { base = 5 }
				}
				culture:northman = {
					weight = { base = 5 }
				}
				culture:tyroshi = {
					weight = { base = 5 }
				}
				culture:harborman = {
					weight = { base = 5 }
				}
				culture:norvoshi = {
					weight = { base = 4 }
				}
				culture:pentoshi = {
					weight = { base = 3 }
				}
				culture:crannogman = {
					weight = { base = 2 }
				}
				culture:ironborn = {
					weight = { base = 2 }
				}
			}

			after_creation = {
				random_list = {
					5 = { add_trait = beauty_good_3 }
					5 = { add_trait = beauty_good_2 }
					10 = { add_trait = beauty_good_1 }
					80 = { }
				}
				if = {
					limit = {
						has_culture = culture:ironborn
					}
					random_list = {
						25 = { set_character_faith = faith:fots_seven }
						75 = { set_character_faith = faith:drowned_god }
					}
				}
				if = {
					limit = {
						has_culture = culture:harborman
					}
					random_list = {
						70 = { set_character_faith = faith:fots_seven}
						30 = { set_Character_faith = faith:old_gods_wnw }
					}
				}
				if = {
					limit = {
						OR = {
							culture = culture:northman
							culture = culture:barrowman
							culture = culture:wolfswood_clansman
							culture = culture:hill_clansman
							culture = culture:crannogman
						}
					}
					random_list = {
					  75 = { set_character_faith = faith:old_gods_wnw }
					  25 = { set_character_faith = faith:fots_seven  }
					}
				}
				if = { #AGOT RELIGION TODO : Reflavorise this
					limit = {
						OR = {
							culture = culture:lyseni
							culture = culture:myrish
							culture = culture:tyroshi
							culture = culture:norvoshi
							culture = culture:braavosi
							culture = culture:pentoshi
						}
					}
					set_character_faith = faith:rhllor_fc
				}
				if = {
					limit = {
						has_trait = dwarf
					}
					remove_trait = dwarf
				}

			}
			save_scope_as = prostitute_character
		}
		hidden_effect = {
			title:b_goldguard_heights.holder = { add_courtier ?= scope:prostitute_character }
		}
	}
	left_portrait = {
		character = scope:prostitute_character
		animation = flirtation
	}
	right_portrait = {
		character = root
		animation = admiration
		outfit_tags = {
			northern_commoner
			generic_legwear
			ep1_adventurer_cloak
			no_hat
		}
	}
	option = {	#  What a wonderful time!
		name = agot_crowned_stag.0003.a
		custom_tooltip = {
			text = agot_crowned_stag.0003.a.tt # You lay with [name]
		}
		remove_short_term_gold = tiny_gold_value
		stress_impact = {
			lustful = medium_stress_impact_loss
		}
		trigger_event = {
			id = agot_crowned_stag.0002
			days = { 360 720 }
		}
		hidden_effect = {
			scope:prostitute_character = {
				make_pregnant = { father = root }
			}
		}
	}
}
