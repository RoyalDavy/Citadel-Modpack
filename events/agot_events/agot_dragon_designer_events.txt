namespace = agot_dragon_designer

scripted_effect open_dragon_customizer = {
	set_variable = {
		name = editing_dragon
		value = scope:dragon
	}
	set_variable = {
		name = value_to_change
		value = 0.01
	}
	add_character_flag = return_to_dragon_customizer
	trigger_event = agot_dragon_maintenance.9999
	if = {
		limit = {
			title:c_ruins.holder = {
				any_owned_story = {
					story_type = story_dragon_variable_storage
					var:dragon_id ?= root.var:editing_dragon
					NOR = {
						exists = var:gene_dragon_primary_color_value_old
						exists = var:gene_dragon_primary_color_hue_old
						exists = var:gene_dragon_secondary_value_old
						exists = var:gene_dragon_secondary_hue_old
						exists = var:gene_dragon_tertiary_value_old
						exists = var:gene_dragon_tertiary_hue_old
						exists = var:gene_dragon_horn_color_value_old
						exists = var:gene_dragon_horn_color_hue_old
						exists = var:gene_dragon_upper_jaw_width_old
						exists = var:gene_dragon_outer_brow_height_old
						exists = var:gene_dragon_chin_profile_old
						exists = var:gene_dragon_snout_length_old
						exists = var:gene_dragon_lower_jaw_width_old
						exists = var:gene_dragon_back_spike_size_old
						exists = var:gene_dragon_crest_depth_old
						exists = var:gene_dragon_brow_width_old
						exists = var:gene_dragon_horns_eyebrow_old
						exists = var:gene_dragon_center_fin_size_old
						exists = var:gene_dragon_neck_length_old
						exists = var:gene_dragon_metallic_scales_strength_old
						exists = var:gene_dragon_wounded_old
						exists = var:gene_dragon_head_roundness_old
						exists = var:gene_dragon_snout_end_width_old
						exists = var:gene_dragon_jaw_width_old
						exists = var:gene_dragon_horns_eyebrow_length_old
						exists = var:gene_dragon_snout_height_old
						exists = var:gene_dragon_lower_jaw_height_old
						exists = var:gene_dragon_neck_spike_size_old
						exists = var:gene_dragon_snout_width_old
						exists = var:gene_dragon_eye_color_value_old
						exists = var:gene_dragon_side_fin_size_old
						exists = var:gene_dragon_old_neck_old
						exists = var:gene_dragon_cheek_width_old
						exists = var:gene_dragon_tail_length_old
						exists = var:gene_dragon_eye_color_hue_old
						exists = var:gene_dragon_main_horn_shape_template_old
						exists = var:gene_dragon_main_horn_shape_value_old
						exists = var:gene_dragon_body_shading_template_old
						exists = var:gene_dragon_body_shading_value_old
						exists = var:gene_dragon_wings_shading_template_old
						exists = var:gene_dragon_wings_shading_value_old
						exists = var:gene_dragon_snout_profile_old
					}
				}
			}
		}
		title:c_ruins.holder = {
			every_owned_story = {
				limit = {
					story_type = story_dragon_variable_storage
					var:dragon_id ?= root.var:editing_dragon
				}
				save_scope_as = story
			}
			scope:story = {
				# Initialize Reset Variables
				set_variable = {
					name = gene_dragon_primary_color_value_old
					value = scope:story.var:gene_dragon_primary_color_value
				}
				set_variable = {
					name = gene_dragon_primary_color_hue_old
					value = scope:story.var:gene_dragon_primary_color_hue
				}
				set_variable = {
					name = gene_dragon_secondary_value_old
					value = scope:story.var:gene_dragon_secondary_value
				}
				set_variable = {
					name = gene_dragon_secondary_hue_old
					value = scope:story.var:gene_dragon_secondary_hue
				}
				set_variable = {
					name = gene_dragon_tertiary_value_old
					value = scope:story.var:gene_dragon_tertiary_value
				}
				set_variable = {
					name = gene_dragon_tertiary_hue_old
					value = scope:story.var:gene_dragon_tertiary_hue
				}
				set_variable = {
					name = gene_dragon_horn_color_value_old
					value = scope:story.var:gene_dragon_horn_color_value
				}
				set_variable = {
					name = gene_dragon_horn_color_hue_old
					value = scope:story.var:gene_dragon_horn_color_hue
				}
				set_variable = {
					name = gene_dragon_upper_jaw_width_old
					value = scope:story.var:gene_dragon_upper_jaw_width
				}

				set_variable = {
					name = gene_dragon_outer_brow_height_old
					value = scope:story.var:gene_dragon_outer_brow_height
				}

				set_variable = {
					name = gene_dragon_chin_profile_old
					value = scope:story.var:gene_dragon_chin_profile
				}

				set_variable = {
					name = gene_dragon_snout_length_old
					value = scope:story.var:gene_dragon_snout_length
				}

				set_variable = {
					name = gene_dragon_lower_jaw_width_old
					value = scope:story.var:gene_dragon_lower_jaw_width
				}

				set_variable = {
					name = gene_dragon_back_spike_size_old
					value = scope:story.var:gene_dragon_back_spike_size
				}

				set_variable = {
					name = gene_dragon_crest_depth_old
					value = scope:story.var:gene_dragon_crest_depth
				}

				set_variable = {
					name = gene_dragon_brow_width_old
					value = scope:story.var:gene_dragon_brow_width
				}

				set_variable = {
					name = gene_dragon_horns_eyebrow_old
					value = scope:story.var:gene_dragon_horns_eyebrow
				}

				set_variable = {
					name = gene_dragon_center_fin_size_old
					value = scope:story.var:gene_dragon_center_fin_size
				}

				set_variable = {
					name = gene_dragon_neck_length_old
					value = scope:story.var:gene_dragon_neck_length
				}
				set_variable = {
					name = gene_dragon_metallic_scales_strength_old
					value = scope:story.var:gene_dragon_metallic_scales_strength
				}
				set_variable = {
					name = gene_dragon_wounded_old
					value = scope:story.var:gene_dragon_wounded
				}
				set_variable = {
					name = gene_dragon_head_roundness_old
					value = scope:story.var:gene_dragon_head_roundness
				}

				set_variable = {
					name = gene_dragon_snout_end_width_old
					value = scope:story.var:gene_dragon_snout_end_width
				}

				set_variable = {
					name = gene_dragon_jaw_width_old
					value = scope:story.var:gene_dragon_jaw_width
				}

				set_variable = {
					name = gene_dragon_horns_eyebrow_length_old
					value = scope:story.var:gene_dragon_horns_eyebrow_length
				}

				set_variable = {
					name = gene_dragon_snout_height_old
					value = scope:story.var:gene_dragon_snout_height
				}

				set_variable = {
					name = gene_dragon_lower_jaw_height_old
					value = scope:story.var:gene_dragon_lower_jaw_height
				}

				set_variable = {
					name = gene_dragon_neck_spike_size_old
					value = scope:story.var:gene_dragon_neck_spike_size
				}

				set_variable = {
					name = gene_dragon_snout_width_old
					value = scope:story.var:gene_dragon_snout_width
				}

				set_variable = {
					name = gene_dragon_eye_color_value_old
					value = scope:story.var:gene_dragon_eye_color_value
				}

				set_variable = {
					name = gene_dragon_side_fin_size_old
					value = scope:story.var:gene_dragon_side_fin_size
				}

				set_variable = {
					name = gene_dragon_old_neck_old
					value = scope:story.var:gene_dragon_old_neck
				}

				set_variable = {
					name = gene_dragon_cheek_width_old
					value = scope:story.var:gene_dragon_cheek_width
				}

				set_variable = {
					name = gene_dragon_tail_length_old
					value = scope:story.var:gene_dragon_tail_length
				}
				set_variable = {
					name = gene_dragon_eye_color_hue_old
					value = scope:story.var:gene_dragon_eye_color_hue
				}
				set_variable = {
					name = gene_dragon_main_horn_shape_template_old
					value = scope:story.var:gene_dragon_main_horn_shape_template
				}

				set_variable = {
					name = gene_dragon_main_horn_shape_value_old
					value = scope:story.var:gene_dragon_main_horn_shape_value
				}
				set_variable = {
					name = gene_dragon_body_shading_template_old
					value = scope:story.var:gene_dragon_body_shading_template
				}

				set_variable = {
					name = gene_dragon_body_shading_value_old
					value = scope:story.var:gene_dragon_body_shading_value
				}
				set_variable = {
					name = gene_dragon_wings_shading_template_old
					value = scope:story.var:gene_dragon_wings_shading_template
				}

				set_variable = {
					name = gene_dragon_wings_shading_value_old
					value = scope:story.var:gene_dragon_wings_shading_value
				}
				set_variable = {
					name = gene_dragon_snout_profile_old
					value = scope:story.var:gene_dragon_snout_profile
				}
			}
		}
	}
}

agot_dragon_designer.0001 = { # A Custom Dragon - Initial Event
	type = character_event
	title = agot_dragon_designer.0001.t
	desc = agot_dragon_designer.0001.desc

	theme = dragon

	override_background = { reference = agot_dragonpit }

	left_portrait = {
		character = root
		animation = worry
	}

	option = {
		name = agot_dragon_designer.0001.egg # Egg
		custom_tooltip = agot_dragon_designer.0001.egg_tt

		trigger_event = agot_dragon_designer.0100 # Choose Color of Egg
	}
	option = {
		name = agot_dragon_designer.0001.a # Pick/Spawn a dragon
		flavor = agot_dragon_designer.0001.a.tt
		trigger_event = agot_dragon_designer.0002
	}
	option = {
		name = agot_dragon_designer.0001.b # Dragon horn
		flavor = agot_dragon_designer.0001.b
		agot_create_artifact_dragon_horn_effect = { OWNER = root DRAGON = root }
		remove_trait = dragonrider
	}
}

agot_dragon_designer.0002 = {
	type = character_event
	title = agot_dragon_designer.0002.t
	desc = agot_dragon_designer.0002.desc

	theme = dragon

	override_background = { reference = agot_dragonpit }

	left_portrait = {
		character = root
		animation = worry
	}

	immediate = {
		if = {
			limit = {
				NOT = {
					exists = scope:dragon_gender
				}
			}
			save_scope_value_as = {
				name = dragon_gender
				value = flag:unspecified
			}
		}
	}

	option = {
		name = {
			text = {
				first_valid = {
					triggered_desc = {
						trigger = {
							scope:dragon_gender = flag:male
						}
						desc = agot_dragon_designer.0002.gender.male
					}
					triggered_desc = {
						trigger = {
							scope:dragon_gender = flag:female
						}
						desc = agot_dragon_designer.0002.gender.female
					}
					desc = agot_dragon_designer.0002.gender.unspecified
				}
			}
		}
		flavor = agot_dragon_designer.0002.gender.tt
		switch = {
			trigger = scope:dragon_gender
			flag:unspecified = {
				save_scope_value_as = {
					name = dragon_gender
					value = flag:male
				}
			}
			flag:male = {
				save_scope_value_as = {
					name = dragon_gender
					value = flag:female
				}
			}
			flag:female = {
				save_scope_value_as = {
					name = dragon_gender
					value = flag:unspecified
				}
			}
		}
		trigger_event = agot_dragon_designer.0002
	}
	option = {
		name = agot_dragon_designer.0002.baby # A Hatchling
		hidden_effect = {
			agot_spawn_wild_child_dragon_effect = yes
		}
		add_character_flag = agot_chose_hatchling_dragon_custom
		trigger_event = agot_dragon_designer.0003
	}
	option = {
		name = agot_dragon_designer.0002.a # A Young Dragon
		hidden_effect = {
			agot_spawn_young_dragon_effect = yes
		}
		add_character_flag = agot_chose_young_dragon_custom
		trigger_event = agot_dragon_designer.0003
	}
	option = {
		name = agot_dragon_designer.0002.b # An Adult Dragon
		hidden_effect = {
			agot_spawn_adult_dragon_effect = yes
		}
		add_character_flag = agot_chose_adult_dragon_custom
		trigger_event = agot_dragon_designer.0003
	}
	option = {
		name = agot_dragon_designer.0002.c # An Old Beast
		hidden_effect = {
			agot_spawn_old_dragon_effect = yes
		}
		add_character_flag = agot_chose_old_dragon_custom
		trigger_event = agot_dragon_designer.0003
	}
	option = {
		name = agot_dragon_designer.0002.d # An Ancient Monster
		hidden_effect = {
			agot_spawn_monster_dragon_effect = yes
		}
		add_character_flag = agot_chose_monster_dragon_custom
		trigger_event = agot_dragon_designer.0003
	}
	option = {
		trigger = {
			any_living_dragon = {
				NOT = { has_character_flag = owned_dragon }
			}
		}
		name = agot_dragon_designer.0002.e # Wild dragon
		flavor = agot_dragon_designer.0002.e.tt
		trigger_event = agot_dragon_designer.0110
	}

	after = {
		if = {
			limit = {
				OR = {
					has_character_flag = agot_chose_hatchling_dragon_custom
					has_character_flag = agot_chose_young_dragon_custom
					has_character_flag = agot_chose_adult_dragon_custom
					has_character_flag = agot_chose_old_dragon_custom
					has_character_flag = agot_chose_monster_dragon_custom
				}
				NOT = {
					scope:dragon_gender = flag:unspecified
				}
			}

			scope:dragon = {
				remove_variable = dragon_gender_hidden
			}
		}
	}
}

agot_dragon_designer.0003 = { # Spawned a dragon
	type = character_event
	title = {
		first_valid = {
			triggered_desc = {
				trigger = { has_character_flag = agot_chose_hatchling_dragon_custom }
				desc = agot_dragon_designer.0003.t_hatchling
			}
			triggered_desc = {
				trigger = { has_character_flag = agot_chose_young_dragon_custom }
				desc = agot_dragon_designer.0003.t_young
			}
			triggered_desc = {
				trigger = { has_character_flag = agot_chose_adult_dragon_custom }
				desc = agot_dragon_designer.0003.t_adult
			}
			triggered_desc = {
				trigger = { has_character_flag = agot_chose_old_dragon_custom }
				desc = agot_dragon_designer.0003.t_old
			}
			desc = agot_dragon_designer.0003.t_ancient
		}
	}
	desc = {
		first_valid = {
			triggered_desc = {
				trigger = { has_character_flag = agot_chose_hatchling_dragon_custom }
				desc = agot_dragon_designer.0003.desc_hatchling
			}
			triggered_desc = {
				trigger = { has_character_flag = agot_chose_young_dragon_custom }
				desc = agot_dragon_designer.0003.desc_young
			}
			triggered_desc = {
				trigger = { has_character_flag = agot_chose_adult_dragon_custom }
				desc = agot_dragon_designer.0003.desc_adult
			}
			triggered_desc = {
				trigger = { has_character_flag = agot_chose_old_dragon_custom }
				desc = agot_dragon_designer.0003.desc_old
			}
			desc = agot_dragon_designer.0003.desc_ancient
		}
	}
	left_portrait = {
		character = root
		animation = personality_bold
	}

	right_portrait = {
		character = scope:dragon
		animation = dragon_main
		camera = camera_dragon_event_standing
		outfit_tags = { linear_camera_zoom }
	}

	theme = dragon

	override_background = { reference = agot_dragonpit }

	immediate = {
		set_variable = {
			name = editing_dragon
			value = scope:dragon
		}
	}

	widgets = {
		widget = {
			gui = "event_window_widget_name_child"
			container = "dynamic_birth_name"
			controller = name_character
			setup_scope = { scope:dragon = { save_scope_as = name_character_target } }
		}
	}

	option = {
		name = {
			text = {
				first_valid = {
					triggered_desc = {
						trigger = {
							has_character_flag = agot_chose_hatchling_dragon_custom
						}
						desc = agot_dragon_designer.0003.a.baby # Skip to physical traits
					}
					desc = agot_dragon_designer.0003.a # Choose traits
				}
			}
		}
		custom_tooltip = agot_dragon_designer.0003.a.tt
		if = {
			limit = {
				NOT = { has_character_flag = agot_chose_hatchling_dragon_custom }
			}
			trigger_event = agot_dragon_designer.0004
		}
		else = {
			trigger_event = agot_dragon_designer.0005
		}
	}

	option = {
		name = agot_dragon_designer.0003.b # Dragon Customization
		custom_tooltip = agot_dragon_designer.0003.b.tt
		open_dragon_customizer = yes
		# Returns via effect in agot_dragon_maintenance.9999
	}

	option = {
		name = agot_dragon_designer.0003.c # The world is mine
		custom_tooltip = agot_dragon_designer.0003.c.tt

		if = {
			limit = {
				NOT = {
					has_character_flag = agot_chose_hatchling_dragon_custom
				}
			}

			# Make sure the dragon has at least 3 personality traits and at least one education trait
			if = {
				limit = {
					scope:dragon = {
						OR = {
							AND = { # Doesn't have any of the education traits
								NOT = { has_trait = education_dragon_1 }
								NOT = { has_trait = education_dragon_2 }
								NOT = { has_trait = education_dragon_3 }
								NOT = { has_trait = education_dragon_4 }
								NOT = { has_trait = education_dragon_5 }
							}
							number_of_personality_traits < 3
						}
					}
				}
				custom_tooltip = agot_dragon_designer.0003.c.needs_traits_tt
				hidden_effect = {
					scope:dragon = {
						if = {
							limit = {
								NOT = { has_trait = education_dragon_1 }
								NOT = { has_trait = education_dragon_2 }
								NOT = { has_trait = education_dragon_3 }
								NOT = { has_trait = education_dragon_4 }
								NOT = { has_trait = education_dragon_5 }
							}
							random_list = {
								1 = { add_trait = education_dragon_1 }
								2 = { add_trait = education_dragon_2 }
								3 = { add_trait = education_dragon_3 }
								2 = { add_trait = education_dragon_4 }
								1 = { add_trait = education_dragon_5 }
							}
						}
						if = {
							limit = { number_of_personality_traits = 0 }
							agot_give_random_dragon_personality_trait = yes
							agot_give_random_dragon_personality_trait = yes
							agot_give_random_dragon_personality_trait = yes
						}
						else_if = {
							limit = { number_of_personality_traits = 1 }
							agot_give_random_dragon_personality_trait = yes
							agot_give_random_dragon_personality_trait = yes
						}
						else_if = {
							limit = { number_of_personality_traits = 2 }
							agot_give_random_dragon_personality_trait = yes
						}
					}
				}
			}

			#Tame the dragon
			agot_tame_dragon = {
				TAMER = root
				DRAGON = scope:dragon
			}
		}
		else = {
			remove_trait = dragonrider
			add_character_flag = historical_dragonseed
			agot_bond_dragon_relation_effect = {
				ACTOR = root
				DRAGON = scope:dragon
			}
		}
		# Remove variables and flags
		remove_variable = editing_dragon
		remove_character_flag = agot_chose_hatchling_dragon_custom
		remove_character_flag = agot_chose_young_dragon_custom
		remove_character_flag = agot_chose_adult_dragon_custom
		remove_character_flag = agot_chose_old_dragon_custom
		remove_character_flag = agot_chose_monster_dragon_custom
	}
}

# Pages of traits to choose from
# TODO: Replace this with a nicer GUI solution somewhere down the line
agot_dragon_designer.0004 = {
	type = character_event
	title = agot_dragon_designer.pages.one
	desc = agot_dragon_designer.0004.desc
	left_portrait = {
		character = root
		animation = personality_bold
	}

	right_portrait = {
		character = scope:dragon
		animation = dragon_main
		camera = camera_dragon_event_standing
		outfit_tags = { linear_camera_zoom }
	}

	theme = dragon

	override_background = { reference = agot_dragonpit }

	# Dragon Education Traits
	option = {
		name = {
			trigger = { scope:dragon = { NOT = { has_trait = education_dragon_1 } } }
			text = agot_dragon_designer.education_dragon_1_add
		}
		name = {
			trigger = { scope:dragon = { has_trait = education_dragon_1 } }
			text = agot_dragon_designer.education_dragon_1_remove
		}
		scope:dragon = {
			if = {
				limit = { NOT = { has_trait = education_dragon_1 } }
				add_trait_force_tooltip = education_dragon_1
				remove_trait = education_dragon_2
				remove_trait = education_dragon_3
				remove_trait = education_dragon_4
				remove_trait = education_dragon_5
			}
			else = {
				remove_trait = education_dragon_1
			}
		}
		trigger_event = agot_dragon_designer.0004
	}
	option = {
		name = {
			trigger = { scope:dragon = { NOT = { has_trait = education_dragon_2 } } }
			text = agot_dragon_designer.education_dragon_2_add
		}
		name = {
			trigger = { scope:dragon = { has_trait = education_dragon_2 } }
			text = agot_dragon_designer.education_dragon_2_remove
		}
		scope:dragon = {
			if = {
				limit = { NOT = { has_trait = education_dragon_2 } }
				add_trait_force_tooltip = education_dragon_2
				remove_trait = education_dragon_1
				remove_trait = education_dragon_3
				remove_trait = education_dragon_4
				remove_trait = education_dragon_5
			}
			else = {
				remove_trait = education_dragon_2
			}
		}
		trigger_event = agot_dragon_designer.0004
	}
	option = {
		name = {
			trigger = { scope:dragon = { NOT = { has_trait = education_dragon_3 } } }
			text = agot_dragon_designer.education_dragon_3_add
		}
		name = {
			trigger = { scope:dragon = { has_trait = education_dragon_3 } }
			text = agot_dragon_designer.education_dragon_3_remove
		}
		scope:dragon = {
			if = {
				limit = { NOT = { has_trait = education_dragon_3 } }
				add_trait_force_tooltip = education_dragon_3
				remove_trait = education_dragon_1
				remove_trait = education_dragon_2
				remove_trait = education_dragon_4
				remove_trait = education_dragon_5
			}
			else = {
				remove_trait = education_dragon_3
			}
		}
		trigger_event = agot_dragon_designer.0004
	}
	option = {
		name = {
			trigger = { scope:dragon = { NOT = { has_trait = education_dragon_4 } } }
			text = agot_dragon_designer.education_dragon_4_add
		}
		name = {
			trigger = { scope:dragon = { has_trait = education_dragon_4 } }
			text = agot_dragon_designer.education_dragon_4_remove
		}
		scope:dragon = {
			if = {
				limit = { NOT = { has_trait = education_dragon_4 } }
				add_trait_force_tooltip = education_dragon_4
				remove_trait = education_dragon_1
				remove_trait = education_dragon_2
				remove_trait = education_dragon_3
				remove_trait = education_dragon_5
			}
			else = {
				remove_trait = education_dragon_4
			}
		}
		trigger_event = agot_dragon_designer.0004
	}
	option = {
		name = {
			trigger = { scope:dragon = { NOT = { has_trait = education_dragon_5 } } }
			text = agot_dragon_designer.education_dragon_5_add
		}
		name = {
			trigger = { scope:dragon = { has_trait = education_dragon_5 } }
			text = agot_dragon_designer.education_dragon_5_remove
		}
		scope:dragon = {
			if = {
				limit = { NOT = { has_trait = education_dragon_5 } }
				add_trait_force_tooltip = education_dragon_5
				remove_trait = education_dragon_1
				remove_trait = education_dragon_2
				remove_trait = education_dragon_3
				remove_trait = education_dragon_4
			}
			else = {
				remove_trait = education_dragon_5
			}
		}
		trigger_event = agot_dragon_designer.0004
	}

	# Back a page
	option = {
		name = agot_dragon_designer.pages.back
		custom_tooltip = agot_dragon_designer.pages.back_tt
		trigger_event = agot_dragon_designer.0008
	}
	# Forward a page
	option = {
		name = agot_dragon_designer.pages.next
		custom_tooltip = agot_dragon_designer.pages.next_tt
		trigger_event = agot_dragon_designer.0005
	}
	# This is my dragon
	option = {
		name = agot_dragon_designer.pages.finish
		custom_tooltip = agot_dragon_designer.pages.finish_tt
		trigger_event = agot_dragon_designer.0003
	}
}

agot_dragon_designer.0005 = {
	type = character_event
	title = {
		first_valid = {
			triggered_desc = {
				trigger = {
					has_character_flag = agot_chose_hatchling_dragon_custom
				}
				desc = agot_dragon_designer.pages
			}
			desc = agot_dragon_designer.pages.two
		}
	}
	desc = agot_dragon_designer.0005.desc
	left_portrait = {
		character = root
		animation = personality_bold
	}

	right_portrait = {
		character = scope:dragon
		animation = dragon_main
		camera = camera_dragon_event_standing
		outfit_tags = { linear_camera_zoom }
	}

	theme = dragon

	override_background = { reference = agot_dragonpit }

	# Upgrade Physique Trait
	option = {
		name = agot_dragon_designer.physique_dragon_upgrade
		trigger = {
			scope:dragon = {
				NOT = { has_trait = dragon_physique_good_3 }
			}
		}
		scope:dragon = {
			if = {
				limit = { has_trait = dragon_physique_bad_3 }
				remove_trait = dragon_physique_bad_3
				add_trait_force_tooltip = dragon_physique_bad_2
			}
			else_if = {
				limit = { has_trait = dragon_physique_bad_2 }
				remove_trait = dragon_physique_bad_2
				add_trait_force_tooltip = dragon_physique_bad_1
			}
			else_if = {
				limit = { has_trait = dragon_physique_bad_1 }
				remove_trait = dragon_physique_bad_1
			}
			else_if = {
				limit = {
					NOR = {
						has_trait = dragon_physique_bad_3
						has_trait = dragon_physique_bad_2
						has_trait = dragon_physique_bad_1
						has_trait = dragon_physique_good_1
						has_trait = dragon_physique_good_2
						has_trait = dragon_physique_good_3
					}
				}
				add_trait_force_tooltip = dragon_physique_good_1
			}
			else_if = {
				limit = { has_trait = dragon_physique_good_1 }
				remove_trait = dragon_physique_good_1
				add_trait_force_tooltip = dragon_physique_good_2
			}
			else_if = {
				limit = { has_trait = dragon_physique_good_2 }
				remove_trait = dragon_physique_good_2
				add_trait_force_tooltip = dragon_physique_good_3
			}
		}
		trigger_event = agot_dragon_designer.0005
	}
	# Downgrade Physique Trait
	option = {
		name = agot_dragon_designer.physique_dragon_downgrade
		trigger = {
			scope:dragon = {
				NOT = { has_trait = dragon_physique_bad_3 }
			}
		}
		scope:dragon = {
			if = {
				limit = { has_trait = dragon_physique_good_3 }
				remove_trait = dragon_physique_good_3
				add_trait_force_tooltip = dragon_physique_good_2
			}
			else_if = {
				limit = { has_trait = dragon_physique_good_2 }
				remove_trait = dragon_physique_good_2
				add_trait_force_tooltip = dragon_physique_good_1
			}
			else_if = {
				limit = { has_trait = dragon_physique_good_1 }
				remove_trait = dragon_physique_good_1
			}
			else_if = {
				limit = {
					NOR = {
						has_trait = dragon_physique_bad_3
						has_trait = dragon_physique_bad_2
						has_trait = dragon_physique_bad_1
						has_trait = dragon_physique_good_1
						has_trait = dragon_physique_good_2
						has_trait = dragon_physique_good_3
					}
				}
				add_trait_force_tooltip = dragon_physique_bad_1
			}
			else_if = {
				limit = { has_trait = dragon_physique_bad_1 }
				remove_trait = dragon_physique_bad_1
				add_trait_force_tooltip = dragon_physique_bad_2
			}
			else_if = {
				limit = { has_trait = dragon_physique_bad_2 }
				remove_trait = dragon_physique_bad_2
				add_trait_force_tooltip = dragon_physique_bad_3
			}
		}
		trigger_event = agot_dragon_designer.0005
	}
	# Swift
	option = {
		name = {
			trigger = { scope:dragon = { NOT = { has_trait = dragon_swift } } }
			text = agot_dragon_designer.pages.swift_add
		}
		name = {
			trigger = { scope:dragon = { has_trait = dragon_swift } }
			text = agot_dragon_designer.pages.swift_remove
		}
		scope:dragon = {
			if = {
				limit = { NOT = { has_trait = dragon_swift } }
				if = {
					limit = { has_trait = dragon_slow }
					remove_trait = dragon_slow
				}
				add_trait_force_tooltip = dragon_swift
			}
			else = {
				remove_trait = dragon_swift
			}
		}
		trigger_event = agot_dragon_designer.0005
	}
	# Slow
	option = {
		name = {
			trigger = { scope:dragon = { NOT = { has_trait = dragon_slow } } }
			text = agot_dragon_designer.pages.slow_add
		}
		name = {
			trigger = { scope:dragon = { has_trait = dragon_slow } }
			text = agot_dragon_designer.pages.slow_remove
		}
		scope:dragon = {
			if = {
				limit = { NOT = { has_trait = dragon_slow } }
				if = {
					limit = { has_trait = dragon_swift }
					remove_trait = dragon_swift
				}
				add_trait_force_tooltip = dragon_slow
			}
			else = {
				remove_trait = dragon_slow
			}
		}
		trigger_event = agot_dragon_designer.0005
	}
	# Majestic
	option = {
		name = {
			trigger = { scope:dragon = { NOT = { has_trait = dragon_majestic } } }
			text = agot_dragon_designer.pages.majestic_add
		}
		name = {
			trigger = { scope:dragon = { has_trait = dragon_majestic } }
			text = agot_dragon_designer.pages.majestic_remove
		}
		scope:dragon = {
			if = {
				limit = { NOT = { has_trait = dragon_majestic } }
				if = {
					limit = { has_trait = dragon_ugly }
					remove_trait = dragon_ugly
				}
				add_trait_force_tooltip = dragon_majestic
			}
			else = {
				remove_trait = dragon_majestic
			}
		}
		trigger_event = agot_dragon_designer.0005
	}
	# Ugly
	option = {
		name = {
			trigger = { scope:dragon = { NOT = { has_trait = dragon_ugly } } }
			text = agot_dragon_designer.pages.ugly_add
		}
		name = {
			trigger = { scope:dragon = { has_trait = dragon_ugly } }
			text = agot_dragon_designer.pages.ugly_remove
		}
		scope:dragon = {
			if = {
				limit = { NOT = { has_trait = dragon_ugly } }
				if = {
					limit = { has_trait = dragon_majestic }
					remove_trait = dragon_majestic
				}
				add_trait_force_tooltip = dragon_ugly
			}
			else = {
				remove_trait = dragon_ugly
			}
		}
		trigger_event = agot_dragon_designer.0005
	}
	# Spindly
	option = {
		name = {
			trigger = { scope:dragon = { NOT = { has_trait = dragon_spindly } } }
			text = agot_dragon_designer.pages.spindly_add
		}
		name = {
			trigger = { scope:dragon = { has_trait = dragon_spindly } }
			text = agot_dragon_designer.pages.spindly_remove
		}
		scope:dragon = {
			if = {
				limit = { NOT = { has_trait = dragon_spindly } }
				add_trait_force_tooltip = dragon_spindly
			}
			else = {
				remove_trait = dragon_spindly
			}
		}
		trigger_event = agot_dragon_designer.0005
	}
	# Fertile
	option = {
		name = {
			trigger = { scope:dragon = { NOT = { has_trait = dragon_fertile } } }
			text = agot_dragon_designer.pages.fertile_add
		}
		name = {
			trigger = { scope:dragon = { has_trait = dragon_fertile } }
			text = agot_dragon_designer.pages.fertile_remove
		}
		scope:dragon = {
			if = {
				limit = { NOT = { has_trait = dragon_fertile } }
				add_trait_force_tooltip = dragon_fertile
			}
			else = {
				remove_trait = dragon_fertile
			}
		}
		trigger_event = agot_dragon_designer.0005
	}

	# Back a page
	option = {
		trigger = {
			NOT = { has_character_flag = agot_chose_hatchling_dragon_custom }
		}
		name = agot_dragon_designer.pages.back
		custom_tooltip = agot_dragon_designer.pages.back_tt
		trigger_event = agot_dragon_designer.0004
	}
	# Forward a page
	option = {
		trigger = {
			NOT = { has_character_flag = agot_chose_hatchling_dragon_custom }
		}
		name = agot_dragon_designer.pages.next
		custom_tooltip = agot_dragon_designer.pages.next_tt
		trigger_event = agot_dragon_designer.0006
	}
	# Only changing the spawn traits for babies
	option = {
		trigger = {
			has_character_flag = agot_chose_hatchling_dragon_custom
		}
		name = agot_dragon_designer.pages.finish
		custom_tooltip = agot_dragon_designer.pages.finish_tt
		trigger_event = agot_dragon_designer.0003
	}
	# Too many genetics to let them finish here...
}

agot_dragon_designer.0006 = {
	type = character_event
	title = agot_dragon_designer.pages.three
	desc = agot_dragon_designer.0006.desc
	left_portrait = {
		character = root
		animation = personality_bold
	}

	right_portrait = {
		character = scope:dragon
		animation = dragon_main
		camera = camera_dragon_event_standing
		outfit_tags = { linear_camera_zoom }
	}

	theme = dragon

	override_background = { reference = agot_dragonpit }

	# Aggressive
	option = {
		name = {
			trigger = { scope:dragon = { NOT = { has_trait = dragon_aggressive } } }
			text = agot_dragon_designer.pages.aggressive_add
		}
		name = {
			trigger = { scope:dragon = { has_trait = dragon_aggressive } }
			text = agot_dragon_designer.pages.aggressive_remove
		}
		scope:dragon = {
			if = {
				limit = { NOT = { has_trait = dragon_aggressive } }
				if = {
					limit = { has_trait = dragon_friendly }
					remove_trait = dragon_friendly
				}
				add_trait_force_tooltip = dragon_aggressive
			}
			else = {
				remove_trait = dragon_aggressive
			}
		}
		trigger_event = agot_dragon_designer.0006
	}
	# Friendly
	option = {
		name = {
			trigger = { scope:dragon = { NOT = { has_trait = dragon_friendly } } }
			text = agot_dragon_designer.pages.friendly_add
		}
		name = {
			trigger = { scope:dragon = { has_trait = dragon_friendly } }
			text = agot_dragon_designer.pages.friendly_remove
		}
		scope:dragon = {
			if = {
				limit = { NOT = { has_trait = dragon_friendly } }
				if = {
					limit = { has_trait = dragon_aggressive }
					remove_trait = dragon_aggressive
				}
				add_trait_force_tooltip = dragon_friendly
			}
			else = {
				remove_trait = dragon_friendly
			}
		}
		trigger_event = agot_dragon_designer.0006
	}
	# Solitary
	option = {
		name = {
			trigger = { scope:dragon = { NOT = { has_trait = dragon_solitary } } }
			text = agot_dragon_designer.pages.solitary_add
		}
		name = {
			trigger = { scope:dragon = { has_trait = dragon_solitary } }
			text = agot_dragon_designer.pages.solitary_remove
		}
		scope:dragon = {
			if = {
				limit = { NOT = { has_trait = dragon_solitary } }
				if = {
					limit = { has_trait = dragon_cooperative }
					remove_trait = dragon_cooperative
				}
				add_trait_force_tooltip = dragon_solitary
			}
			else = {
				remove_trait = dragon_solitary
			}
		}
		trigger_event = agot_dragon_designer.0006
	}
	# Cooperative
	option = {
		name = {
			trigger = { scope:dragon = { NOT = { has_trait = dragon_cooperative } } }
			text = agot_dragon_designer.pages.cooperative_add
		}
		name = {
			trigger = { scope:dragon = { has_trait = dragon_cooperative } }
			text = agot_dragon_designer.pages.cooperative_remove
		}
		scope:dragon = {
			if = {
				limit = { NOT = { has_trait = dragon_cooperative } }
				if = {
					limit = { has_trait = dragon_solitary }
					remove_trait = dragon_solitary
				}
				add_trait_force_tooltip = dragon_cooperative
			}
			else = {
				remove_trait = dragon_cooperative
			}
		}
		trigger_event = agot_dragon_designer.0006
	}
	# Imperious
	option = {
		name = {
			trigger = { scope:dragon = { NOT = { has_trait = dragon_imperious } } }
			text = agot_dragon_designer.pages.imperious_add
		}
		name = {
			trigger = { scope:dragon = { has_trait = dragon_imperious } }
			text = agot_dragon_designer.pages.imperious_remove
		}
		scope:dragon = {
			if = {
				limit = { NOT = { has_trait = dragon_imperious } }
				if = {
					limit = { has_trait = dragon_supporting }
					remove_trait = dragon_supporting
				}
				add_trait_force_tooltip = dragon_imperious
			}
			else = {
				remove_trait = dragon_imperious
			}
		}
		trigger_event = agot_dragon_designer.0006
	}
	# Supporting
	option = {
		name = {
			trigger = { scope:dragon = { NOT = { has_trait = dragon_supporting } } }
			text = agot_dragon_designer.pages.supporting_add
		}
		name = {
			trigger = { scope:dragon = { has_trait = dragon_supporting } }
			text = agot_dragon_designer.pages.supporting_remove
		}
		scope:dragon = {
			if = {
				limit = { NOT = { has_trait = dragon_supporting } }
				if = {
					limit = { has_trait = dragon_imperious }
					remove_trait = dragon_imperious
				}
				add_trait_force_tooltip = dragon_supporting
			}
			else = {
				remove_trait = dragon_supporting
			}
		}
		trigger_event = agot_dragon_designer.0006
	}
	# Back a page
	option = {
		name = agot_dragon_designer.pages.back
		custom_tooltip = agot_dragon_designer.pages.back_tt
		trigger_event = agot_dragon_designer.0005
	}
	# Forward a page
	option = {
		name = agot_dragon_designer.pages.next
		custom_tooltip = agot_dragon_designer.pages.next_tt
		trigger_event = agot_dragon_designer.0007
	}
	# This is my dragon
	option = {
		name = agot_dragon_designer.pages.finish
		custom_tooltip = agot_dragon_designer.pages.finish_tt
		trigger_event = agot_dragon_designer.0003
	}
}

agot_dragon_designer.0007 = {
	type = character_event
	title = agot_dragon_designer.pages.four
	desc = agot_dragon_designer.0007.desc
	left_portrait = {
		character = root
		animation = personality_bold
	}

	right_portrait = {
		character = scope:dragon
		animation = dragon_main
		camera = camera_dragon_event_standing
		outfit_tags = { linear_camera_zoom }
	}

	theme = dragon

	override_background = { reference = agot_dragonpit }

	# Impulsive
	option = {
		name = {
			trigger = { scope:dragon = { NOT = { has_trait = dragon_impulsive } } }
			text = agot_dragon_designer.pages.impulsive_add
		}
		name = {
			trigger = { scope:dragon = { has_trait = dragon_impulsive } }
			text = agot_dragon_designer.pages.impulsive_remove
		}
		scope:dragon = {
			if = {
				limit = { NOT = { has_trait = dragon_impulsive } }
				if = {
					limit = { has_trait = dragon_calculating }
					remove_trait = dragon_calculating
				}
				add_trait_force_tooltip = dragon_impulsive
			}
			else = {
				remove_trait = dragon_impulsive
			}
		}
		trigger_event = agot_dragon_designer.0007
	}
	# Calculating
	option = {
		name = {
			trigger = { scope:dragon = { NOT = { has_trait = dragon_calculating } } }
			text = agot_dragon_designer.pages.calculating_add
		}
		name = {
			trigger = { scope:dragon = { has_trait = dragon_calculating } }
			text = agot_dragon_designer.pages.calculating_remove
		}
		scope:dragon = {
			if = {
				limit = { NOT = { has_trait = dragon_calculating } }
				if = {
					limit = { has_trait = dragon_impulsive }
					remove_trait = dragon_impulsive
				}
				add_trait_force_tooltip = dragon_calculating
			}
			else = {
				remove_trait = dragon_calculating
			}
		}
		trigger_event = agot_dragon_designer.0007
	}
	# Voracious
	option = {
		name = {
			trigger = { scope:dragon = { NOT = { has_trait = dragon_voracious } } }
			text = agot_dragon_designer.pages.voracious_add
		}
		name = {
			trigger = { scope:dragon = { has_trait = dragon_voracious } }
			text = agot_dragon_designer.pages.voracious_remove
		}
		scope:dragon = {
			if = {
				limit = { NOT = { has_trait = dragon_voracious } }
				if = {
					limit = { has_trait = dragon_restrained }
					remove_trait = dragon_restrained
				}
				add_trait_force_tooltip = dragon_voracious
			}
			else = {
				remove_trait = dragon_voracious
			}
		}
		trigger_event = agot_dragon_designer.0007
	}
	# Restrained
	option = {
		name = {
			trigger = { scope:dragon = { NOT = { has_trait = dragon_restrained } } }
			text = agot_dragon_designer.pages.restrained_add
		}
		name = {
			trigger = { scope:dragon = { has_trait = dragon_restrained } }
			text = agot_dragon_designer.pages.restrained_remove
		}
		scope:dragon = {
			if = {
				limit = { NOT = { has_trait = dragon_restrained } }
				if = {
					limit = { has_trait = dragon_voracious }
					remove_trait = dragon_voracious
				}
				add_trait_force_tooltip = dragon_restrained
			}
			else = {
				remove_trait = dragon_restrained
			}
		}
		trigger_event = agot_dragon_designer.0007
	}
	# Back a page
	option = {
		name = agot_dragon_designer.pages.back
		custom_tooltip = agot_dragon_designer.pages.back_tt
		trigger_event = agot_dragon_designer.0006
	}
	# Forward a page
	option = {
		name = agot_dragon_designer.pages.next
		custom_tooltip = agot_dragon_designer.pages.next_tt
		trigger_event = agot_dragon_designer.0008
	}
	# This is my dragon
	option = {
		name = agot_dragon_designer.pages.finish
		custom_tooltip = agot_dragon_designer.pages.finish_tt
		trigger_event = agot_dragon_designer.0003
	}
}

agot_dragon_designer.0008 = {
	type = character_event
	title = agot_dragon_designer.pages.five
	desc = agot_dragon_designer.0008.desc
	left_portrait = {
		character = root
		animation = personality_bold
	}

	right_portrait = {
		character = scope:dragon
		animation = dragon_main
		camera = camera_dragon_event_standing
		outfit_tags = { linear_camera_zoom }
	}

	theme = dragon

	override_background = { reference = agot_dragonpit }

	# Defiant
	option = {
		name = {
			trigger = { scope:dragon = { NOT = { has_trait = dragon_defiant } } }
			text = agot_dragon_designer.pages.defiant_add
		}
		name = {
			trigger = { scope:dragon = { has_trait = dragon_defiant } }
			text = agot_dragon_designer.pages.defiant_remove
		}
		scope:dragon = {
			if = {
				limit = { NOT = { has_trait = dragon_defiant } }
				if = {
					limit = { has_trait = dragon_accepting }
					remove_trait = dragon_accepting
				}
				add_trait_force_tooltip = dragon_defiant
			}
			else = {
				remove_trait = dragon_defiant
			}
		}
		trigger_event = agot_dragon_designer.0008
	}
	# Accepting
	option = {
		name = {
			trigger = { scope:dragon = { NOT = { has_trait = dragon_accepting } } }
			text = agot_dragon_designer.pages.accepting_add
		}
		name = {
			trigger = { scope:dragon = { has_trait = dragon_accepting } }
			text = agot_dragon_designer.pages.accepting_remove
		}
		scope:dragon = {
			if = {
				limit = { NOT = { has_trait = dragon_accepting } }
				if = {
					limit = { has_trait = dragon_defiant }
					remove_trait = dragon_defiant
				}
				add_trait_force_tooltip = dragon_accepting
			}
			else = {
				remove_trait = dragon_accepting
			}
		}
		trigger_event = agot_dragon_designer.0008
	}
	# Bloodthirsty
	option = {
		name = {
			trigger = { scope:dragon = { NOT = { has_trait = dragon_bloodthirsty } } }
			text = agot_dragon_designer.pages.bloodthirsty_add
		}
		name = {
			trigger = { scope:dragon = { has_trait = dragon_bloodthirsty } }
			text = agot_dragon_designer.pages.bloodthirsty_remove
		}
		scope:dragon = {
			if = {
				limit = { NOT = { has_trait = dragon_bloodthirsty } }
				if = {
					limit = { has_trait = dragon_skittish }
					remove_trait = dragon_skittish
				}
				add_trait_force_tooltip = dragon_bloodthirsty
			}
			else = {
				remove_trait = dragon_bloodthirsty
			}
		}
		trigger_event = agot_dragon_designer.0008
	}
	# Skittish
	option = {
		name = {
			trigger = { scope:dragon = { NOT = { has_trait = dragon_skittish } } }
			text = agot_dragon_designer.pages.skittish_add
		}
		name = {
			trigger = { scope:dragon = { has_trait = dragon_skittish } }
			text = agot_dragon_designer.pages.skittish_remove
		}
		scope:dragon = {
			if = {
				limit = { NOT = { has_trait = dragon_skittish } }
				if = {
					limit = { has_trait = dragon_bloodthirsty }
					remove_trait = dragon_bloodthirsty
				}
				add_trait_force_tooltip = dragon_skittish
			}
			else = {
				remove_trait = dragon_skittish
			}
		}
		trigger_event = agot_dragon_designer.0008
	}

	# Back a page
	option = {
		name = agot_dragon_designer.pages.back
		custom_tooltip = agot_dragon_designer.pages.back_tt
		trigger_event = agot_dragon_designer.0007
	}
	# Forward a page
	option = {
		name = agot_dragon_designer.pages.next
		custom_tooltip = agot_dragon_designer.pages.next_tt
		trigger_event = agot_dragon_designer.0004
	}
	# This is my dragon
	option = {
		name = agot_dragon_designer.pages.finish
		custom_tooltip = agot_dragon_designer.pages.finish_tt
		trigger_event = agot_dragon_designer.0003
	}
}

##############
# Egg Events #
##############
agot_dragon_designer.0100 = { # Actually it's an egg
	type = character_event
	title = agot_dragon_designer.0100.eggs.t
	desc = agot_dragon_designer.0100.eggs.desc

	theme = dragon

	override_background = { reference = agot_dragonpit }

	left_portrait = {
		character = root
		animation = worry
	}
	immediate = {
		clear_saved_scope = dragon_parent #this is broken
		save_scope_as = dragon_parent #workaround, will only add to egg if dragon
		hidden_effect = { agot_create_every_dragon_egg_artifact = { OWNER = title:c_ruins.holder } }

		title:c_ruins.holder = {
			every_character_artifact = {
				limit = {
					has_variable = dragon_egg
				}
				root = {
					add_to_variable_list = {
						name = possible_artifacts
						target = prev
					}
				}
			}
		}
	}

	widget = {
		is_shown = {
			is_ai = no
		}
		gui = "event_window_artifact_selection_tall"
		container = "custom_widgets_container"
	}

	option = {
		name = agot_dragon_designer.0100.eggs.a
		if = {
			limit = {
				NOT = { exists = root.var:selected_artifact }
			}
			hidden_effect = { agot_create_random_dragon_egg_artifact = { OWNER = root } }
		}
		else = {
			agot_create_dragon_egg_from_selection = { OWNER = root }
		}

		remove_trait = dragonrider
		add_character_flag = historical_dragonseed
	}
	option = { # Random Egg
		name = agot_dragon_designer.0100.eggs.b
		custom_tooltip = agot_dragon_designer.0100.eggs.b.tt

		remove_trait = dragonrider
		hidden_effect = {
			agot_create_random_dragon_egg_artifact = { OWNER = root }
			add_character_flag = historical_dragonseed
		}
	}

	after = {
		# scrambled egg maker
		trigger_event = {
			id = agot_dragon_designer.0101
			months = 1
		}
		clear_variable_list = possible_artifacts
		remove_variable = selected_artifact
	}
}

agot_dragon_designer.0101 = { #clean up variables for egg maker
	hidden = yes

	immediate = {
		title:c_ruins.holder = {
			every_character_artifact = {
				limit = { has_variable = dragon_egg }
				destroy_artifact = this
			}
		}
	}
}

agot_dragon_designer.0110 = {
	type = character_event
	title = agot_dragon_designer.0110.t
	desc = agot_dragon_designer.0110.desc

	theme = dragon

	left_portrait = {
		character = root
	}

	widget = {
		is_shown = {
			is_ai = no
		}
		gui = "event_window_character_selection_two_options"
		container = "custom_widgets_container"
	}

	immediate = {
		every_living_dragon = {
			limit = {
				NOT = { has_character_flag = owned_dragon }
			}
			root = {
				add_to_variable_list = {
					name = possible_characters
					target = prev
				}
			}
		}

		ordered_in_list = {
			variable = possible_characters
			order_by = dragon_size
			root = { set_variable = { name = si_selected_character value = prev } }
			save_scope_as = dragon
		}
	}

	option = {
		name = agot_dragon_designer.0110.a

		var:si_selected_character ?= {
			save_scope_as = dragon
		}

		if = { # MP Proofing
			limit = {
				scope:dragon = {
					NOT = { has_character_flag = owned_dragon }
				}
			}

			agot_tame_dragon = {
				TAMER = root
				DRAGON = scope:dragon
			}
			add_character_flag = dd_tamed_wild_dragon
			send_interface_toast = {
				title = agot_dragon_designer.0110.toast_tamed
				left_icon = scope:dragon
			}
		}
		else = {
			send_interface_toast = {
				title = agot_dragon_designer.0110.toast_invalid
				left_icon = scope:dragon
				custom_tooltip = agot_dragon_designer.0110.toast_invalid_desc
				trigger_event = agot_dragon_designer.0001
			}
		}

		ai_chance = {
			base = 1
		}
	}

	option = {
		name = agot_dragon_designer.0110.b
		flavor = agot_dragon_designer.0110.b.tt
		trigger_event = agot_dragon_designer.0002

		ai_chance = {
			base = 0
		}
	}

	after = {
		if = {
			limit = {
				has_character_flag = dd_tamed_wild_dragon
				NOT = {
					has_variable = current_dragon
				}
			}
			trigger_event = agot_dragon_designer.0001 # something went wrong
		}
		remove_character_flag = dd_tamed_wild_dragon
		remove_variable = si_selected_character
		clear_variable_list = possible_characters
	}
}

agot_dragon_designer.2000 = { #Wall/BTW
	type = character_event
	title = agot_dragon_designer.2000.t
	desc = agot_dragon_designer.2000.desc

	theme = dragon

	override_background = { reference = agot_dragonpit }

	left_portrait = {
		character = root
		animation = worry
	}

	immediate = {
		remove_trait = dragonrider
	}

	option = {
		name = agot_dragon_designer.2000.egg # Egg
		custom_tooltip = agot_dragon_designer.2000.egg_tt

		trigger_event = agot_dragon_designer.0100 # Choose Color of Egg
	}

	option = {
		name = agot_dragon_designer.2000.dragon_horn
		flavor = agot_dragon_designer.2000.dragon_horn.tt
		agot_create_artifact_dragon_horn_effect = { OWNER = root DRAGON = root }
		remove_trait = dragonrider
	}
}