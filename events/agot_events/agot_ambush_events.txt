namespace = agot_ambush_events

# EVENTS FOR AMBUSHES
# 0001 Cleanup
# 1001 Chasmfiend
# 2001 Generic rogue army

# Ambush in the Neck EVENTS - Army Owner
agot_ambush_events.1001 = {
	title = agot_ambush_events.1001.title
	type = character_event
	trigger = {
		scope:army = {
			location = { geographical_region = world_westeros_the_neck }
			is_army_in_combat = no
			#army_is_moving = yes
		}
		scope:army.location.county.holder = { save_temporary_scope_as = shrek }
		OR = {
			scope:shrek = {
				is_at_war_with = root
			}
			scope:shrek = {
				any_liege_or_above = {
					is_at_war_with = root
				}
			}
		}
		NOR = {
			#don't share a top liege
			root = scope:shrek.top_liege
			top_liege = scope:shrek.top_liege
			root.culture = { has_cultural_tradition = agot_tradition_crannogman }
			has_culture = culture:crannogman
			any_character_war = {
				using_cb = crannogman_ambush_cb
			}
		}
	}
	immediate = {
		hidden_effect = {
			root = {
				scope:army = { location = { save_scope_as = target_location } }
				agot_create_crannogman_ambush = {
					TARGET = root
				}
			}
		}
	}
	theme = war
	override_background = {
		reference = wilderness_wetlands
	}

	left_portrait = {
		character = root
		animation = personality_bold
	}
	desc = agot_ambush_events.1001.desc
	option = {
		name = agot_ambush_events.1001.attack
		stress_impact = {
			craven = major_stress_impact_gain
		}
		agot_spawn_crannogman_army = {TARGET = root}
	}
}


# Wildlings walking throught the wall Pop-op
agot_ambush_events.1002 = {
	title = agot_ambush_events.1002.title
	type = character_event

	theme = war
	override_background = {
		reference = agot_frozen_forest
	}

	left_portrait = {
		character = root
		animation = personality_bold
	}
	desc = agot_ambush_events.1002.desc

	#Continue
	option = {
		name = agot_ambush_events.1002.attack
		hidden_effect = {
			scope:scopearmy = { set_army_location = scope:thewallprovince }
		}
		add_character_flag = {
			flag = wildling_raid_happened
			years = 2
		}
		start_war = {
			cb = wildling_raid_cb
			target = scope:thewallprovince.county.holder.top_liege
			target_title = scope:thewallprovince.county
		}

		ai_chance = {
			base = 0
			ai_value_modifier = { ai_boldness = 1 }
		}
	}
	#Go Back
	option = {
		name = agot_ambush_events.1002.leave
		hidden_effect = {
			scope:scopearmy = { set_army_location = scope:old_locationscope }
		}

		ai_chance = {
			base = 50

			modifier = {
				add = 50
				current_military_strength <= 500
			}
		}
	}
}

# # ROGUE ARMY
# agot_ambush_events.2001 = {
# 	title = agot_ambush_events.2001.title
# 	type = character_event
# 	trigger = {
# 		is_ai = no
# 		is_commanding_army = yes
# 		exists = commanding_army.location.county
# 		OR = {
# 			is_at_war = yes
# 			commanding_army = { is_raid_army = yes }
# 		}
# 		commanding_army = {
# 			is_army_in_combat = no
# 			army_is_moving = yes
# 			location = { NOT = { geographical_region = region_shattered_plains } }
# 		}
# 		NOR = {
# 			commanding_army.location.county_controller = root
# 			commanding_army.location.county_controller = { is_liege_or_above_of = root }
# 			has_relation_friend = commanding_army.location.county_controller
# 			#commanding_army.location.county_controller = { has_dread_level_towards = { target = prev level > 0 } }
# 		}
# 	}
# 	weight_multiplier = {
# 		base = 100
# 		modifier = {
# 			add = { value = commanding_army.location.county.county_control multiply = -1 }
# 		}
# 		modifier = {
# 			factor = 10
# 			has_relation_rival = commanding_army.location.county_controller
# 		}
# 		modifier = {
# 			factor = 0.01
# 		}
# 	}
# 	immediate = {
# 		hidden_effect = {
# 			root = {
# 				create_rogue_general = {
# 					TARGET = root
# 				}
# 				commanding_army = { location = { save_scope_as = target_location } }
# 				random_character_war = {save_scope_as = rogue_war}
# 			}
# 		}
# 	}
# 	theme = war

# 	left_portrait = {
# 		character = root
# 		animation = personality_bold
# 	}
# 	right_portrait = {
# 		character = scope:rogue_general
# 		animation = personality_bold
# 	}
# 	desc = agot_ambush_events.2001.desc
# 	option = {
# 		name = agot_ambush_events.2001.pay
# 		pay_short_term_gold	= { target = scope:rogue_general gold = major_gold_value }
# 		add_prestige = -100
# 		stress_impact = {
# 			base = 13
# 			brave = major_stress_impact_gain
# 			greedy = major_stress_impact_gain
# 			arrogant = major_stress_impact_gain
# 			ambitious = medium_stress_impact_gain
# 		}
# 	}
# 	option = {
# 		name = agot_ambush_events.2001.fight
# 		spawn_rogue_army_as_enemy = { TARGET = root }
# 		stress_impact = {
# 			craven = major_stress_impact_gain
# 		}
# 	}
# 	option = {
# 		trigger = {
# 			is_commanding_army = yes
# 			is_at_war = yes
# 			is_radiant_2 = yes
# 			OR = {
# 				is_bondsmith = yes
# 				is_lightweaver = yes
# 			}
# 		}
# 		flavor = available_because_of_your_radiant_order
# 		name = agot_ambush_events.2001.recruit
# 		#custom_tooltip = agot_ambush_events.2001.recruit_tt
# 		pay_short_term_gold	 = { target = scope:rogue_general gold = major_gold_value }
# 		remove_investiture = { AMOUNT = major_gold_value }
# 		spawn_rogue_army_as_ally = {TARGET = root}
# 		if = {
# 			limit = {
# 				has_bonded_spren = yes
# 			}
# 			delay_ideal = { MONTHS = -2 }
# 		}
# 		trait = bondsmith_1
# 		trait = bondsmith_2
# 		trait = bondsmith_3
# 		trait = bondsmith_4
# 		trait = bondsmith_5
# 		trait = lightweaver_1
# 		trait = lightweaver_2
# 		trait = lightweaver_3
# 		trait = lightweaver_4
# 		trait = lightweaver_5
# 	}
# 	option = {
# 		trigger = {
# 			exists = var:artifact_nightblood_equipped
# 			has_variable = artifact_nightblood_equipped
# 		}
# 		name = agot_ambush_events.2001.nightblood
# 		draw_nightblood = yes
# 		remove_investiture = { AMOUNT = 100 }
# 		trigger_event = agot_ambush_events.2002
# 	}
# }
# agot_ambush_events.2002 = {
# 	title = agot_ambush_events.2002.title
# 	trigger = {
# 		is_commanding_army = yes
# 	}
# 	theme = war

# 	left_portrait = {
# 		character = root
# 		animation = rage
# 	}
# 	right_portrait = {
# 		character = scope:rogue_general
# 		animation = shock
# 	}
# 	desc = agot_ambush_events.2002.desc
# 	option = {
# 		name = agot_ambush_events.2002.a
# 		trigger_event = agot_ambush_events.2003
# 		add_dread = 50
# 	}
# }
# agot_ambush_events.2003 = {
# 	title = agot_ambush_events.2002.title
# 	trigger = {
# 		is_commanding_army = yes
# 	}
# 	immediate = {
# 		custom_tooltip = agot_ambush_events.2003.past
# 	}
# 	theme = war

# 	left_portrait = {
# 		character = root
# 		animation = war_over_win
# 	}
# 	desc = agot_ambush_events.2003.desc
# 	option = {
# 		name = agot_ambush_events.2003.a
# 		add_prestige = 350
# 	}
# }